
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Amazon API Gateway Integrations &#8212; Smithy 0.1.0 documentation</title><link rel="stylesheet" href="../_static/bootstrap-reboot.css" type="text/css" />
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx_tabs/tabs.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.2.10/segment.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.2.10/menu.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.2.10/tab.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom-tabs.css" type="text/css" />

    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sphinx_tabs/tabs.js"></script>
    <script type="text/javascript" src="../_static/sphinx_tabs/semantic-ui-2.2.10/tab.min.js"></script>
    <script type="text/javascript">
        function _scroll(subjectId) {
            var subjectElement = $(subjectId);
            var actualSubjectHeight = subjectElement.height();
            var startingPosition = subjectElement[0].getBoundingClientRect().top;
            return function() {
                var availableHeight = $(window).height() - startingPosition;
                // Subtract the scroll position to account for sticky movement.
                availableHeight += Math.min($(window).scrollTop(), 40);
                var cappedHeight = Math.min(actualSubjectHeight, availableHeight);
                if (subjectElement.css("height") !== cappedHeight) {
                    subjectElement.css("height", cappedHeight);
                }
            };
        }

        // Scroll and resize the the columns when scrolled.
        $(function() {
            var rightScroll = _scroll("#right-column > .column-body");
            var scrollFn = function() {
                rightScroll.call(this, arguments);
            };
            scrollFn();
            $(window).scroll(scrollFn);
            $(window).resize(scrollFn);
        });

        // Scroll spy to change highlighted navigation element.
        $(function() {
            var section = document.querySelectorAll(".section");
            var sections = {};
            var i = 0;
            Array.prototype.forEach.call(section, function(e) {
                sections[e.id] = e.offsetTop;
            });
            var scrollSpy = function() {
                var scrollPosition = document.documentElement.scrollTop || document.body.scrollTop;
                for (i in sections) {
                    if (sections[i] <= scrollPosition) {
                        $('#right-column .current').removeClass('current');
                        $("#right-column a[href='#" + i + "']").addClass('current');
                    }
                }
            };
            $(window).scroll(scrollSpy);
            scrollSpy();
        });
    </script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Smithy Guides" href="../guides/index.html" />
    <link rel="prev" title="AWS Core Specification" href="aws-core.html" /> 
  </head><body>
    <header>
        <div class="header-flex width-wrapper">
            <div class="site-logo">
                <a href="../index.html">
                    <span class="logo-icon">⚒️</span><span class="logo-text">Smithy</span><span class="beta-text">beta</span>
                </a>
            </div>
            <ul id="page-navigation">
                <li class="site-page first"><a href="../quickstart.html">Quick Start</a></li>
                <li class="site-page"><a href="index.html">Specifications</a></li>
                <li class="site-page"><a href="../guides/index.html">Guides</a></li>
                <li class="site-page"><a href="https://github.com/awslabs/smithy">Code</a></li>
                <li class="site-search hidden-sm">
                    <form action="../search.html" method="get">
                        <input type="hidden" name="check_keywords" value="yes" />
                        <input type="hidden" name="area" value="default" />
                        <input class="search-input" autocomplete="off" type="search" name="q" placeholder="Search" />
                    </form>
                </li>
            </ul>
        </div>
    </header>
    
        
        
        <section id="page-container">
            <div class="width-wrapper flex">
                <article id="document-body">
                    
  <div class="section" id="amazon-api-gateway-integrations">
<h1>Amazon API Gateway Integrations<a class="headerlink" href="#amazon-api-gateway-integrations" title="Permalink to this headline">¶</a></h1>
<p>Smithy can integrate with Amazon API Gateway using traits, authentication
schemes, and OpenAPI specifications.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of contents</p>
<ul class="simple">
<li><a class="reference internal" href="#amazon-api-gateway-traits" id="id7">Amazon API Gateway traits</a><ul>
<li><a class="reference internal" href="#aws-apigateway-apikeysource-trait" id="id8"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#apiKeySource</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-authorizers-trait" id="id9"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizers</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-authorizer-trait" id="id10"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizer</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-requestvalidator-trait" id="id11"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#requestValidator</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-integration-trait" id="id12"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#integration</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-mockintegration-trait" id="id13"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#mockIntegration</span></code> trait</a></li>
<li><a class="reference internal" href="#shared-trait-data-types" id="id14">Shared trait data types</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="amazon-api-gateway-traits">
<h2>Amazon API Gateway traits<a class="headerlink" href="#amazon-api-gateway-traits" title="Permalink to this headline">¶</a></h2>
<div class="section" id="aws-apigateway-apikeysource-trait">
<span id="id1"></span><h3><code class="docutils literal notranslate"><span class="pre">aws.apigateway#apiKeySource</span></code> trait<a class="headerlink" href="#aws-apigateway-apikeysource-trait" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Summary</dt>
<dd>Specifies the source of the caller identifier that will be used to
throttle API methods that require a key.</dd>
<dt>Trait selector</dt>
<dd><code class="docutils literal notranslate"><span class="pre">service</span></code></dd>
<dt>Value type</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">string</span></code> set to one of the following values:</p>
<table border="1" class="colwidths-given last docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>HEADER</td>
<td>for receiving the API key from the X-API-Key header of a request</td>
</tr>
<tr class="row-odd"><td>AUTHORIZER</td>
<td>for receiving the API key from the UsageIdentifierKey
from a Lambda authorizer (formerly known as a custom authorizer)</td>
</tr>
</tbody>
</table>
</dd>
<dt>See also</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-usage-plans.html">Create and Use Usage Plans with API Keys</a> for more on usage plans and
API keys</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-api-key-source.html">Choose an API Key Source</a> for information on choosing a source</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-api-key-source.html">x-amazon-apigateway-api-key-source</a> for how this relates to OpenAPI</li>
</ul>
</dd>
</dl>
<p>The following example sets the <code class="docutils literal notranslate"><span class="pre">X-API-Key</span></code> header as the API key source.</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-U21pdGh5 docutils container">
<div class="docutils container">
Smithy</div>
</div>
<div class="item sphinx-data-tab-SlNPTg== docutils container">
<div class="docutils container">
JSON</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-U21pdGh5 active docutils container">
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="nc"> &quot;0.1.0&quot;</span>
<span class="kd">namespace</span><span class="nc"> smithy.example</span>

<span class="nd">@aws.apigateway#apiKeySource</span>(<span class="n">HEADER</span>)
<span class="kd">service</span><span class="nc"> Weather</span> {
  <span class="nl">version:</span> <span class="s2">&quot;2018-03-17&quot;</span>
}
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-SlNPTg== docutils container">
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;smithy.example&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;Weather&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service&quot;</span><span class="p">,</span>
        <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-03-17&quot;</span><span class="p">,</span>
        <span class="nt">&quot;aws.apigateway#apiKeySource&quot;</span><span class="p">:</span> <span class="s2">&quot;HEADER&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-authorizers-trait">
<span id="id2"></span><h3><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizers</span></code> trait<a class="headerlink" href="#aws-apigateway-authorizers-trait" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Summary</dt>
<dd><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-authorizer.html">Lambda authorizers</a> to attach to the authentication schemes defined on
this service.</dd>
<dt>Trait selector</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">service[trait|protocols]</span></code></p>
<p class="last"><em>A service shape that has the protocols trait</em></p>
</dd>
<dt>Value type</dt>
<dd>Map of arbitrary names to <em>authorizer</em> definitions. These authorizer
definitions are applied to a service, resource, or operation using the
<a class="reference internal" href="#aws-apigateway-authorizer-trait"><span class="std std-ref">aws.apigateway#authorizer trait</span></a>.</dd>
</dl>
<p>An <em>authorizer</em> definition is an object that supports the following properties:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>type</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required</strong>. The type of the authorizer. This is a required property
and the value must be &quot;token&quot;, for an authorizer with the caller
identity embedded in an authorization token, or &quot;request&quot;, for an
authorizer with the caller identity contained in request parameters.</td>
</tr>
<tr class="row-odd"><td>scheme</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required</strong>. A Smithy authentication scheme name that identifies how
a client authenticates. This value MUST reference one of the <code class="docutils literal notranslate"><span class="pre">auth</span></code>
schemes of the <a class="reference internal" href="core.html#protocols-trait"><span class="std std-ref">protocols trait</span></a> attached to the service.</td>
</tr>
<tr class="row-even"><td>uri</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required.</strong> Specifies the authorizer's Uniform Resource Identifier
(URI). For <code class="docutils literal notranslate"><span class="pre">token</span></code> or <code class="docutils literal notranslate"><span class="pre">request</span></code> authorizers, this must be a
well-formed Lambda function URI, for example,
<code class="docutils literal notranslate"><span class="pre">arn:aws:apigateway:us-west-2:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-2:{account_id}:function:{lambda_function_name}/invocations</span></code>.
In general, the URI has this form <code class="docutils literal notranslate"><span class="pre">arn:aws:apigateway:{region}:lambda:path/{service_api}</span></code>,
where <code class="docutils literal notranslate"><span class="pre">{region}</span></code> is the same as the region hosting the Lambda
function, path indicates that the remaining substring in the URI
should be treated as the path to the resource, including the initial
<code class="docutils literal notranslate"><span class="pre">/</span></code>. For Lambda functions, this is usually of the form
<code class="docutils literal notranslate"><span class="pre">/2015-03-31/functions/[FunctionARN]/invocations</span></code>.</td>
</tr>
<tr class="row-odd"><td>credentials</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies the required credentials as an IAM role for API Gateway to
invoke the authorizer. To specify an IAM role for API Gateway to
assume, use the role's Amazon Resource Name (ARN). This value MUST
be omitted in order to use resource-based permissions on the
Lambda function.</td>
</tr>
<tr class="row-even"><td>identitySource</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><p class="first">The identity source for which authorization is requested.</p>
<p>For a <code class="docutils literal notranslate"><span class="pre">token</span></code> or <code class="docutils literal notranslate"><span class="pre">cognito_user_pools</span></code> authorizer, this is required
and specifies the request header mapping expression for the custom
header holding the authorization token submitted by the client. For
example, if the token header name is Auth, the header mapping
expression is <code class="docutils literal notranslate"><span class="pre">method.request.header.Auth</span></code>.</p>
<p class="last">For the <code class="docutils literal notranslate"><span class="pre">request</span></code> authorizer, this is required when authorization
caching is enabled. The value is a comma-separated string of one or
more mapping expressions of the specified request parameters. For
example, if an Auth header and a Name query string parameter are
defined as identity sources, this value is <code class="docutils literal notranslate"><span class="pre">method.request.header.Auth,</span> <span class="pre">method.request.querystring.Name</span></code>.
These parameters will be used to derive the authorization caching
key and to perform runtime validation of the <code class="docutils literal notranslate"><span class="pre">request</span></code> authorizer
by verifying all of the identity-related request parameters are
present, not null and non-empty. Only when this is true does the
authorizer invoke the authorizer Lambda function, otherwise, it
returns a 401 Unauthorized response without calling the Lambda
function. The valid value is a string of comma-separated mapping
expressions of the specified request parameters. When the
authorization caching is not enabled, this property is optional.</p>
</td>
</tr>
<tr class="row-odd"><td>identityValidationExpression</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>A validation expression for the incoming identity token. For <code class="docutils literal notranslate"><span class="pre">token</span></code>
authorizers, this value is a regular expression. API Gateway will
match the aud field of the incoming token from the client against
the specified regular expression. It will invoke the authorizer's
Lambda function when there is a match. Otherwise, it will return a
401 Unauthorized response without calling the Lambda function. The
validation expression does not apply to the <code class="docutils literal notranslate"><span class="pre">request</span></code> authorizer.</td>
</tr>
<tr class="row-even"><td>resultTtlInSeconds</td>
<td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>The TTL in seconds of cached authorizer results. If it equals 0,
authorization caching is disabled. If it is greater than 0,
API Gateway will cache authorizer responses. If this field is not set,
the default value is 300. The maximum value is 3600, or 1 hour.</td>
</tr>
</tbody>
</table>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ns.foo&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;Weather&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service&quot;</span><span class="p">,</span>
                <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-03-17&quot;</span><span class="p">,</span>
                <span class="nt">&quot;protocols&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;aws.rest-json&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;auth&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;aws.v4&quot;</span><span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="nt">&quot;aws.apigateway#authorizer&quot;</span><span class="p">:</span> <span class="s2">&quot;arbitrary-name&quot;</span><span class="p">,</span>
                <span class="nt">&quot;aws.apigateway#authorizers&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;arbitrary-name&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;scheme&quot;</span><span class="p">:</span> <span class="s2">&quot;aws.v4&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;request&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:foo:baz&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;credentials&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:foo:bar&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;identitySource&quot;</span><span class="p">:</span> <span class="s2">&quot;mapping.expression&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;identityValidationExpression&quot;</span><span class="p">:</span> <span class="s2">&quot;[A-Z]+&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;resultTtlInSeconds&quot;</span><span class="p">:</span><span class="mi">100</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-authorizer-trait">
<span id="id3"></span><h3><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizer</span></code> trait<a class="headerlink" href="#aws-apigateway-authorizer-trait" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Summary</dt>
<dd>Applies a Lambda authorizer to a service, resource, or operation.
Authorizers are resolved hierarchically: an operation inherits
the effective authorizer applied to a parent resource or operation.</dd>
<dt>Trait selector</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">:each(service,</span> <span class="pre">resource,</span> <span class="pre">operation)</span></code></p>
<p class="last"><em>A service, resource, or operation</em></p>
</dd>
<dt>Value type</dt>
<dd>String value that MUST reference one of the keys in the
<a class="reference internal" href="#aws-apigateway-authorizers-trait"><span class="std std-ref">aws.apigateway#authorizers trait</span></a> of the service that contains
the shape.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-requestvalidator-trait">
<span id="id4"></span><h3><code class="docutils literal notranslate"><span class="pre">aws.apigateway#requestValidator</span></code> trait<a class="headerlink" href="#aws-apigateway-requestvalidator-trait" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Summary</dt>
<dd>Opts-in to Amazon API Gateway request validation for a service or
operation.</dd>
<dt>Trait selector</dt>
<dd><code class="docutils literal notranslate"><span class="pre">:test(service,</span> <span class="pre">operation)</span></code></dd>
<dt>Value type</dt>
<dd><p class="first"><code class="docutils literal notranslate"><span class="pre">string</span></code> value set to one of the following:</p>
<table border="1" class="colwidths-given last docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>full</td>
<td>The parameters and body of a request are validated.</td>
</tr>
<tr class="row-odd"><td>params-only</td>
<td>Only the parameters of a request are validated.</td>
</tr>
<tr class="row-even"><td>body-only</td>
<td>Only the body of a request is validated.</td>
</tr>
</tbody>
</table>
</dd>
<dt>See also</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-method-request-validation.html">Enable Request Validation in API Gateway</a> for more information</li>
<li><a class="reference internal" href="../guides/converting-to-openapi.html#apigateway-request-validators"><span class="std std-ref">Request validators</span></a> for information on how this converts
to OpenAPI</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-request-validators.requestValidator.html">x-amazon-apigateway-request-validator</a> for more on how this converts
to OpenAPI</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-request-validators.html">x-amazon-apigateway-request-validators</a> for more on how this converts
to OpenAPI</li>
</ul>
</dd>
</dl>
<p>Then following example enables request validation on a service:</p>
<div class="sphinx-tabs docutils container">
<div class="ui top attached tabular menu sphinx-menu docutils container">
<div class="active item sphinx-data-tab-U21pdGh5 docutils container">
<div class="docutils container">
Smithy</div>
</div>
<div class="item sphinx-data-tab-SlNPTg== docutils container">
<div class="docutils container">
JSON</div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-U21pdGh5 active docutils container">
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="nc"> &quot;0.1.0&quot;</span>
<span class="kd">namespace</span><span class="nc"> smithy.example</span>

<span class="nd">@aws.apigateway#requestValidator</span>(<span class="n">full</span>)
<span class="kd">service</span><span class="nc"> Weather</span> {
  <span class="nl">version:</span> <span class="s2">&quot;2018-03-17&quot;</span>
}
</pre></div>
</div>
</div>
<div class="ui bottom attached sphinx-tab tab segment code-tab sphinx-data-tab-SlNPTg== docutils container">
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
  <span class="nt">&quot;smithy.example&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;Weather&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service&quot;</span><span class="p">,</span>
        <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-03-17&quot;</span><span class="p">,</span>
        <span class="nt">&quot;aws.apigateway#requestValidator&quot;</span><span class="p">:</span> <span class="s2">&quot;full&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-integration-trait">
<span id="id5"></span><h3><code class="docutils literal notranslate"><span class="pre">aws.apigateway#integration</span></code> trait<a class="headerlink" href="#aws-apigateway-integration-trait" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Summary</dt>
<dd>Defines an <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/">API Gateway integration</a> that integrates with an actual
backend.</dd>
<dt>Trait selector</dt>
<dd><code class="docutils literal notranslate"><span class="pre">:test(service,</span> <span class="pre">operation)</span></code></dd>
<dt>Value type</dt>
<dd><code class="docutils literal notranslate"><span class="pre">object</span></code> value.</dd>
<dt>See also</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="../guides/converting-to-openapi.html#apigateway-integrations"><span class="std std-ref">Integrations</span></a> for information on how this converts
to OpenAPI</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/">API Gateway Integration</a> for in-depth API documentation</li>
<li><a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-swagger-extensions-integration.html">x-amazon-apigateway-integration</a> for details on how this looks
to OpenAPI</li>
</ul>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">aws.apigateway#integration</span></code> trait is an object that supports the
following properties:</p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>type</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><p class="first"><strong>Required.</strong> The type of integration with the specified backend.
Valid values are:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">http</span></code> or <code class="docutils literal notranslate"><span class="pre">http_proxy</span></code>: for integration with an HTTP backend</li>
<li><code class="docutils literal notranslate"><span class="pre">aws_proxy</span></code>: for integration with AWS Lambda functions</li>
<li><code class="docutils literal notranslate"><span class="pre">aws</span></code>: for integration with AWS Lambda functions or other AWS
services such as Amazon DynamoDB, Amazon Simple Notification Service
or Amazon Simple Queue Service.</li>
</ul>
</td>
</tr>
<tr class="row-odd"><td>uri</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required.</strong> The endpoint URI of the backend. For integrations of
the <code class="docutils literal notranslate"><span class="pre">aws</span></code> type, this is an ARN value. For the HTTP integration,
this is the URL of the HTTP endpoint including the <code class="docutils literal notranslate"><span class="pre">https</span></code> or
<code class="docutils literal notranslate"><span class="pre">http</span></code> scheme.</td>
</tr>
<tr class="row-even"><td>httpMethod</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td><strong>Required.</strong> Specifies the integration's HTTP method type
(for example, <code class="docutils literal notranslate"><span class="pre">POST</span></code>). For Lambda function invocations, the value
must be <code class="docutils literal notranslate"><span class="pre">POST</span></code>.</td>
</tr>
<tr class="row-odd"><td>credentials</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies the credentials required for the integration, if any. For
AWS IAM role-based credentials, specify the ARN of an appropriate
IAM role. If unspecified, credentials will default to resource-based
permissions that must be added manually to allow the API to access
the resource. For more information, see
<a class="reference external" href="https://docs.aws.amazon.com/lambda/latest/dg/intro-permission-model.html#intro-permission-model-access-policy">Granting Permissions Using a Resource Policy</a>.</td>
</tr>
<tr class="row-even"><td>passThroughBehavior</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies how a request payload of unmapped content type is passed
through the integration request without modification. Supported
values are <code class="docutils literal notranslate"><span class="pre">when_no_templates</span></code>, <code class="docutils literal notranslate"><span class="pre">when_no_match</span></code>, and <code class="docutils literal notranslate"><span class="pre">never</span></code>.
For more information, see <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/#passthroughBehavior">Integration.passthroughBehavior</a>.</td>
</tr>
<tr class="row-odd"><td>contentHandling</td>
<td><a class="reference internal" href="#apigateway-content-handling"><span class="std std-ref">ContentHandling string</span></a></td>
<td>Request payload content handling.</td>
</tr>
<tr class="row-even"><td>timeoutInMillis</td>
<td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>Integration timeouts between 50 ms and 29,000 ms.</td>
</tr>
<tr class="row-odd"><td>connectionId</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>The ID of a <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/vpc-link/">VpcLink</a> for the private integration.</td>
</tr>
<tr class="row-even"><td>connectionType</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>The type of the network connection to the integration endpoint.
The valid value is <code class="docutils literal notranslate"><span class="pre">INTERNET</span></code> for connections through the public
routable internet or <code class="docutils literal notranslate"><span class="pre">VPC_LINK</span></code> for private connections between
API Gateway and a network load balancer in a VPC. The default
value is <code class="docutils literal notranslate"><span class="pre">INTERNET</span></code>.</td>
</tr>
<tr class="row-odd"><td>cacheNamespace</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>An API-specific tag group of related cached parameters.</td>
</tr>
<tr class="row-even"><td>cacheKeyParameters</td>
<td><code class="docutils literal notranslate"><span class="pre">[string]</span></code></td>
<td>A list of request parameter names whose values are to be cached.</td>
</tr>
<tr class="row-odd"><td>requestParameters</td>
<td><code class="docutils literal notranslate"><span class="pre">Map</span></code> of <a class="reference internal" href="#apigateway-requestparameters"><span class="std std-ref">requestParameters object</span></a> to request parameters</td>
<td>Specifies mappings from method request parameters to integration
request parameters. Supported request parameters are querystring,
path, header, and body.</td>
</tr>
<tr class="row-even"><td>requestTemplates</td>
<td><code class="docutils literal notranslate"><span class="pre">Map</span></code> of media types to <a class="reference internal" href="#apigateway-requesttemplates"><span class="std std-ref">requestTemplates object</span></a></td>
<td>Mapping templates for a request payload of specified media types.</td>
</tr>
<tr class="row-odd"><td>responses</td>
<td><code class="docutils literal notranslate"><span class="pre">Map</span></code> of response codes to <a class="reference internal" href="#apigateway-responses"><span class="std std-ref">responses object</span></a></td>
<td>Defines the method's responses and specifies desired parameter
mappings or payload mappings from integration responses to method
responses.</td>
</tr>
</tbody>
</table>
<p>The following example defines an integration that is applied to every
operation within the service.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;smithy.example&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;Weather&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;service&quot;</span><span class="p">,</span>
                <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;2018-03-17&quot;</span><span class="p">,</span>
                <span class="nt">&quot;protocols&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;aws.rest-json&quot;</span><span class="p">,</span> <span class="nt">&quot;auth&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;aws.v4&quot;</span><span class="p">]}],</span>
                <span class="nt">&quot;aws.apigateway#integration&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;aws&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;uri&quot;</span> <span class="p">:</span> <span class="s2">&quot;arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:012345678901:function:HelloWorld/invocations&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;httpMethod&quot;</span> <span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;credentials&quot;</span> <span class="p">:</span> <span class="s2">&quot;arn:aws:iam::012345678901:role/apigateway-invoke-lambda-exec-role&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;requestTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;requestParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;integration.request.path.stage&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.querystring.version&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;integration.request.querystring.provider&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.querystring.vendor&quot;</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;cacheNamespace&quot;</span> <span class="p">:</span> <span class="s2">&quot;cache namespace&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;cacheKeyParameters&quot;</span> <span class="p">:</span> <span class="p">[],</span>
                    <span class="nt">&quot;responses&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;2\\d{2}&quot;</span> <span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.requestId&quot;</span> <span class="p">:</span> <span class="s2">&quot;integration.response.header.cid&quot;</span>
                            <span class="p">},</span>
                            <span class="nt">&quot;responseTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                                <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;302&quot;</span> <span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;302&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.Location&quot;</span> <span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;default&quot;</span> <span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;400&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.test-method-response-header&quot;</span> <span class="p">:</span> <span class="s2">&quot;&#39;static value&#39;&quot;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="aws-apigateway-mockintegration-trait">
<span id="id6"></span><h3><code class="docutils literal notranslate"><span class="pre">aws.apigateway#mockIntegration</span></code> trait<a class="headerlink" href="#aws-apigateway-mockintegration-trait" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Summary</dt>
<dd>Defines an <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/">API Gateway integration</a> that returns a mock response.</dd>
<dt>Trait selector</dt>
<dd><code class="docutils literal notranslate"><span class="pre">:test(service,</span> <span class="pre">operation)</span></code></dd>
<dt>Value type</dt>
<dd><code class="docutils literal notranslate"><span class="pre">object</span></code> value.</dd>
</dl>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>passThroughBehavior</td>
<td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>Specifies how a request payload of unmapped content type is passed
through the integration request without modification. Supported
values are <code class="docutils literal notranslate"><span class="pre">when_no_templates</span></code>, <code class="docutils literal notranslate"><span class="pre">when_no_match</span></code>, and <code class="docutils literal notranslate"><span class="pre">never</span></code>.
For more information, see <a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration/#passthroughBehavior">Integration.passthroughBehavior</a>.</td>
</tr>
<tr class="row-odd"><td>requestParameters</td>
<td><code class="docutils literal notranslate"><span class="pre">Map</span></code> of <a class="reference internal" href="#apigateway-requestparameters"><span class="std std-ref">requestParameters object</span></a> to request parameters</td>
<td>Specifies mappings from method request parameters to integration
request parameters. Supported request parameters are querystring,
path, header, and body.</td>
</tr>
<tr class="row-even"><td>requestTemplates</td>
<td><code class="docutils literal notranslate"><span class="pre">Map</span></code> of media types to <a class="reference internal" href="#apigateway-requesttemplates"><span class="std std-ref">requestTemplates object</span></a></td>
<td>Mapping templates for a request payload of specified media types.</td>
</tr>
<tr class="row-odd"><td>responses</td>
<td><code class="docutils literal notranslate"><span class="pre">Map</span></code> of response codes to <a class="reference internal" href="#apigateway-responses"><span class="std std-ref">responses object</span></a></td>
<td>Defines the method's responses and specifies desired parameter
mappings or payload mappings from integration responses to method
responses.</td>
</tr>
</tbody>
</table>
<p>The following example defines an operation that uses a mock integration.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;smithy&quot;</span><span class="p">:</span> <span class="s2">&quot;0.1.0&quot;</span><span class="p">,</span>
    <span class="nt">&quot;smithy.example&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;shapes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;MyOperation&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;operation&quot;</span><span class="p">,</span>
                <span class="nt">&quot;http&quot;</span><span class="p">:</span> <span class="p">{</span><span class="nt">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="nt">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;/2&quot;</span><span class="p">},</span>
                <span class="nt">&quot;aws.apigateway#mockIntegration&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;requestTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;requestParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;integration.request.path.stage&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.querystring.version&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;integration.request.querystring.provider&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.querystring.vendor&quot;</span>
                    <span class="p">},</span>
                    <span class="nt">&quot;responses&quot;</span> <span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;2\\d{2}&quot;</span> <span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.requestId&quot;</span> <span class="p">:</span> <span class="s2">&quot;integration.response.header.cid&quot;</span>
                            <span class="p">},</span>
                            <span class="nt">&quot;responseTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                                <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;302&quot;</span> <span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;302&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.Location&quot;</span> <span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span>
                            <span class="p">}</span>
                        <span class="p">},</span>
                        <span class="nt">&quot;default&quot;</span> <span class="p">:</span> <span class="p">{</span>
                            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;400&quot;</span><span class="p">,</span>
                            <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                                <span class="nt">&quot;method.response.header.test-method-response-header&quot;</span> <span class="p">:</span> <span class="s2">&quot;&#39;static value&#39;&quot;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This trait should be considered internal-only and not exposed to your
customers.</p>
</div>
</div>
<div class="section" id="shared-trait-data-types">
<h3>Shared trait data types<a class="headerlink" href="#shared-trait-data-types" title="Permalink to this headline">¶</a></h3>
<p>The following shapes are used throughout the Smithy API Gateway traits
definitions.</p>
<div class="section" id="contenthandling-string">
<span id="apigateway-content-handling"></span><h4>ContentHandling string<a class="headerlink" href="#contenthandling-string" title="Permalink to this headline">¶</a></h4>
<p>Defines the payload conversion handling of a request or response.
Valid values are:</p>
<ul class="simple">
<li>CONVERT_TO_TEXT: for converting a binary payload into a
Base64-encoded string or converting a text payload into a
utf-8-encoded string or passing through the text payload natively
without modification</li>
<li>CONVERT_TO_BINARY: for converting a text payload into
Base64-decoded blob or passing through a binary payload natively
without modification.</li>
</ul>
</div>
<div class="section" id="requestparameters-object">
<span id="apigateway-requestparameters"></span><h4>requestParameters object<a class="headerlink" href="#requestparameters-object" title="Permalink to this headline">¶</a></h4>
<p>Specifies mappings from named method request parameters to integration
request parameters. The method request parameters must be defined before
they are referenced.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="30%" />
<col width="10%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">integration.request.&lt;param-type&gt;.&lt;param-name&gt;</span></code></td>
<td>string</td>
<td>The value must be a predefined method request parameter of the
<code class="docutils literal notranslate"><span class="pre">method.request.&lt;param-type&gt;.&lt;param-name&gt;</span></code> format, where
<code class="docutils literal notranslate"><span class="pre">&lt;param-type&gt;</span></code> can be querystring, path, header, or body. For
the body parameter, the <code class="docutils literal notranslate"><span class="pre">&lt;param-name&gt;</span></code> is a JSON path expression
without the <code class="docutils literal notranslate"><span class="pre">$.</span></code> prefix.</td>
</tr>
</tbody>
</table>
<p>The following request parameter mappings example translates a method
request's query (version), header (x-user-id) and path (service)
parameters to the integration request's query (stage),
header (x-userid), and path parameters (op), respectively.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;requestParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;integration.request.querystring.stage&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.querystring.version&quot;</span><span class="p">,</span>
        <span class="nt">&quot;integration.request.header.x-userid&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.header.x-user-id&quot;</span><span class="p">,</span>
        <span class="nt">&quot;integration.request.path.op&quot;</span> <span class="p">:</span> <span class="s2">&quot;method.request.path.service&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="requesttemplates-object">
<span id="apigateway-requesttemplates"></span><h4>requestTemplates object<a class="headerlink" href="#requesttemplates-object" title="Permalink to this headline">¶</a></h4>
<p>Specifies mapping templates for a request payload of the specified media types.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">&lt;Media</span> <span class="pre">type&gt;</span></code></td>
<td>string</td>
<td>A <a class="reference external" href="mappingtemplates">mapping template</a>.</td>
</tr>
</tbody>
</table>
<p>The following example sets mapping templates for a request payload of the
<code class="docutils literal notranslate"><span class="pre">application/json</span></code> and <code class="docutils literal notranslate"><span class="pre">application/xml</span></code> media types.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;requestTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
        <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="responses-object">
<span id="apigateway-responses"></span><h4>responses object<a class="headerlink" href="#responses-object" title="Permalink to this headline">¶</a></h4>
<p>Defines the method's responses and specifies parameter mappings or payload
mappings from integration responses to method responses.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="20%" />
<col width="10%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">&lt;Response</span> <span class="pre">status</span> <span class="pre">pattern&gt;</span></code></td>
<td><a class="reference internal" href="#apigateway-response-object"><span class="std std-ref">Response object</span></a></td>
<td><p class="first">Selection regular expression used to match the integration response
to the method response. For HTTP integrations, this regex applies to
the integration response status code. For Lambda invocations, the
regex applies to the errorMessage field of the error information
object returned by AWS Lambda as a failure response body when the
Lambda function execution throws an exception.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Response status pattern property name refers to a response
status code or regular expression describing a group of response
status codes. It does not correspond to any identifier of an
<a class="reference external" href="https://docs.aws.amazon.com/apigateway/api-reference/resource/integration-response/">IntegrationResponse</a> resource in the API Gateway REST API.</p>
</div>
</td>
</tr>
</tbody>
</table>
<p>The following example shows a list of responses from <code class="docutils literal notranslate"><span class="pre">2xx</span></code> and <code class="docutils literal notranslate"><span class="pre">302</span></code>
responses. For the <code class="docutils literal notranslate"><span class="pre">2xx</span></code> response, the method response is mapped from
the integration response's payload of the <code class="docutils literal notranslate"><span class="pre">application/json</span></code> or
<code class="docutils literal notranslate"><span class="pre">application/xml</span></code> media type. This response uses the supplied mapping
templates. For the <code class="docutils literal notranslate"><span class="pre">302</span></code> response, the method response returns a
<code class="docutils literal notranslate"><span class="pre">Location</span></code> header whose value is derived from the <code class="docutils literal notranslate"><span class="pre">redirect.url</span></code>
property on the integration response's payload.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;responses&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;2\\d{2}&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;200&quot;</span><span class="p">,</span>
            <span class="nt">&quot;responseTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
                <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nt">&quot;302&quot;</span> <span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;302&quot;</span><span class="p">,</span>
            <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;method.response.header.Location&quot;</span><span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="response-object">
<span id="apigateway-response-object"></span><h4>response object<a class="headerlink" href="#response-object" title="Permalink to this headline">¶</a></h4>
<p>Defines a response and specifies parameter mappings or payload mappings from
the integration response to the method response.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="30%" />
<col width="10%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>statusCode</td>
<td>string</td>
<td>HTTP status code for the method response; for example, &quot;200&quot;. This
must correspond to a matching response in the OpenAPI Operation
responses field.</td>
</tr>
<tr class="row-odd"><td>responseTemplates</td>
<td><a class="reference internal" href="#apigateway-response-templates-object"><span class="std std-ref">Response templates object</span></a></td>
<td>Specifies media type-specific mapping templates for the response's
payload.</td>
</tr>
<tr class="row-even"><td>responseParameters</td>
<td><a class="reference internal" href="#apigateway-response-parameters-object"><span class="std std-ref">Response parameters object</span></a></td>
<td>Specifies parameter mappings for the response. Only the header and
body parameters of the integration response can be mapped to the header
parameters of the method.</td>
</tr>
<tr class="row-odd"><td>contentHandling</td>
<td><a class="reference internal" href="#apigateway-content-handling"><span class="std std-ref">ContentHandling string</span></a></td>
<td>Response payload content handling.</td>
</tr>
</tbody>
</table>
<p>The following example defines a 302 response for the method that derives a
payload of the <code class="docutils literal notranslate"><span class="pre">application/json</span></code> or <code class="docutils literal notranslate"><span class="pre">application/xml</span></code> media type from the
backend. The response uses the supplied mapping templates and returns the
redirect URL from the integration response in the method's Location header.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;statusCode&quot;</span> <span class="p">:</span> <span class="s2">&quot;302&quot;</span><span class="p">,</span>
    <span class="nt">&quot;responseTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
         <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
         <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;method.response.header.Location&quot;</span><span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="response-templates-object">
<span id="apigateway-response-templates-object"></span><h4>Response templates object<a class="headerlink" href="#response-templates-object" title="Permalink to this headline">¶</a></h4>
<p>Specifies mapping templates for a response payload of the specified
media types.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="30%" />
<col width="10%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">&lt;Media</span> <span class="pre">type&gt;</span></code></td>
<td>string</td>
<td>Specifies a mapping template to transform the integration response
body to the method response body for a given media type. For
information about creating a mapping template, see
<a class="reference external" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/models-mappings.html#models-mappings-mappings">mapping Templates</a>. An example of a media type is
<code class="docutils literal notranslate"><span class="pre">application/json</span></code>.</td>
</tr>
</tbody>
</table>
<p>The following example sets mapping templates for a request payload of the
<code class="docutils literal notranslate"><span class="pre">application/json</span></code> and <code class="docutils literal notranslate"><span class="pre">application/xml</span></code> media types.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;responseTemplates&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;application/json&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) { \&quot;stage\&quot;: \&quot;$root.name\&quot;, \&quot;user-id\&quot;: \&quot;$root.key\&quot; }&quot;</span><span class="p">,</span>
        <span class="nt">&quot;application/xml&quot;</span> <span class="p">:</span> <span class="s2">&quot;#set ($root=$input.path(&#39;$&#39;)) &lt;stage&gt;$root.name&lt;/stage&gt; &quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="response-parameters-object">
<span id="apigateway-response-parameters-object"></span><h4>Response parameters object<a class="headerlink" href="#response-parameters-object" title="Permalink to this headline">¶</a></h4>
<p>Specifies mappings from integration method response parameters to method
response parameters. Only the <code class="docutils literal notranslate"><span class="pre">header</span></code> and <code class="docutils literal notranslate"><span class="pre">body</span></code> types of the integration
response parameters can be mapped to the <code class="docutils literal notranslate"><span class="pre">header</span></code> type of the method
response.</p>
<p><strong>Properties</strong></p>
<table border="1" class="colwidths-given docutils">
<colgroup>
<col width="30%" />
<col width="10%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Property</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">method.response.header.&lt;param-name&gt;</span></code></td>
<td>string</td>
<td>The named parameter value can be derived from the header and body
types of the integration response parameters only.</td>
</tr>
</tbody>
</table>
<p>The following example maps <code class="docutils literal notranslate"><span class="pre">body</span></code> and <code class="docutils literal notranslate"><span class="pre">header</span></code> parameters of the
integration response to two <code class="docutils literal notranslate"><span class="pre">header</span></code> parameters of the method response.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;responseParameters&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;method.response.header.Location&quot;</span> <span class="p">:</span> <span class="s2">&quot;integration.response.body.redirect.url&quot;</span><span class="p">,</span>
        <span class="nt">&quot;method.response.header.x-user-id&quot;</span> <span class="p">:</span> <span class="s2">&quot;integration.response.header.x-userid&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>



                    
                    <section class="relations">
                        
                        <a href="aws-core.html" title="previous chapter" class="previous-page clearfix hidden-xs">← AWS Core Specification</a>
                        
                        <a href="../guides/index.html" title="next chapter" class="next-page clearfix">Smithy Guides →</a>
                    </section>
                    
                </article><aside id="right-column" class="side-column hidden-sm">
                    <div class="column-body">
                        <section class="sidebar">
                            <ul>
<li><a class="reference internal" href="#">Amazon API Gateway Integrations</a><ul>
<li><a class="reference internal" href="#amazon-api-gateway-traits">Amazon API Gateway traits</a><ul>
<li><a class="reference internal" href="#aws-apigateway-apikeysource-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#apiKeySource</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-authorizers-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizers</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-authorizer-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#authorizer</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-requestvalidator-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#requestValidator</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-integration-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#integration</span></code> trait</a></li>
<li><a class="reference internal" href="#aws-apigateway-mockintegration-trait"><code class="docutils literal notranslate"><span class="pre">aws.apigateway#mockIntegration</span></code> trait</a></li>
<li><a class="reference internal" href="#shared-trait-data-types">Shared trait data types</a><ul>
<li><a class="reference internal" href="#contenthandling-string">ContentHandling string</a></li>
<li><a class="reference internal" href="#requestparameters-object">requestParameters object</a></li>
<li><a class="reference internal" href="#requesttemplates-object">requestTemplates object</a></li>
<li><a class="reference internal" href="#responses-object">responses object</a></li>
<li><a class="reference internal" href="#response-object">response object</a></li>
<li><a class="reference internal" href="#response-templates-object">Response templates object</a></li>
<li><a class="reference internal" href="#response-parameters-object">Response parameters object</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                        </section>
                    </div>
                </aside></div>
        </section>
        
    
<footer id="footer">
    <div class="width-wrapper">
        <div class="copyright">
            <p>©2019, Amazon Web Services, Inc or its affiliates. All rights reserved.</p>
        </div>
    </div>
</footer>
  </body>
</html>