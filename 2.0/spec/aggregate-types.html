<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="4. Service types" href="service-types.html" /><link rel="prev" title="2. Simple types" href="simple-types.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><meta name="generator" content="sphinx-5.3.0, furo 2022.06.21"/>
        <title>3. Aggregate types - Smithy 2.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 100%;
  --admonition-title-font-size: 100%;
  --color-brand-primary: #C44536;
  --color-brand-content: #00808b;
  --color-announcement-background: #711818de;
  --color-announcement-text: #fff;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #282828;
  --color-code-foreground: #dddddd;
  --color-brand-primary: #ed9d13;
  --color-brand-content: #58d3ff;
  --color-announcement-background: #711818de;
  --color-announcement-text: #fff;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #282828;
  --color-code-foreground: #dddddd;
  --color-brand-primary: #ed9d13;
  --color-brand-content: #58d3ff;
  --color-announcement-background: #711818de;
  --color-announcement-text: #fff;
  
      }
    }
  }
</style><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js"></script>
<script src="https://d2c.aws.amazon.com/client/loader/v1/d2c-load.js"></script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Smithy 2.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/smithy.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick start</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Smithy specification</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="model.html">1. The Smithy model</a></li>
<li class="toctree-l2"><a class="reference internal" href="simple-types.html">2. Simple types</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">3. Aggregate types</a></li>
<li class="toctree-l2"><a class="reference internal" href="service-types.html">4. Service types</a></li>
<li class="toctree-l2"><a class="reference internal" href="mixins.html">5. Mixins</a></li>
<li class="toctree-l2"><a class="reference internal" href="constraint-traits.html">6. Constraint traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="type-refinement-traits.html">7. Type refinement traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation-traits.html">8. Documentation traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="behavior-traits.html">9. Behavior traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="resource-traits.html">10. Resource traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="authentication-traits.html">11. Authentication traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="protocol-traits.html">12. Serialization and Protocol traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="streaming.html">13. Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="http-bindings.html">14. HTTP bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="endpoint-traits.html">15. Endpoint traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="selectors.html">16. Selectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="model-validation.html">17. Model validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="idl.html">18. Smithy IDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="json-ast.html">19. JSON AST</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../trait-index.html">Trait index</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/smithy-cli/index.html">The Smithy CLI</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../guides/smithy-cli/cli_installation.html">Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides/smithy-build-json.html">smithy-build.json</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/gradle-plugin/index.html">Smithy Gradle Plugins</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../guides/gradle-plugin/gradle-migration-guide.html">Migrating to Gradle plugin version 0.10.0+</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/using-code-generation/index.html">Code Generation</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../guides/using-code-generation/update-model.html">Updating the Smithy Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/using-code-generation/generating-a-client.html">Generating a client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides/model-linters.html">Linting Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/model-validation-examples.html">Model Validation Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/evolving-models.html">Evolving Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/style-guide.html">Style Guide</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/model-translations/index.html">Model Translations</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../guides/model-translations/converting-to-openapi.html">Converting Smithy to OpenAPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/model-translations/migrating-idl-1-to-2.html">Smithy IDL 1.0 to 2.0 Migration Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/model-translations/generating-cloudformation-resources.html">Generating CloudFormation Resource Schemas from Smithy</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/building-codegen/index.html">Creating a Code Generator</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../guides/building-codegen/overview-and-concepts.html">Overview and Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/building-codegen/mapping-shapes-to-languages.html">Mapping Smithy Shapes to Your Language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/building-codegen/creating-codegen-repo.html">Creating a Codegen Repo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/building-codegen/configuring-the-generator.html">Configuring the Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/building-codegen/implementing-the-generator.html">Implementing the Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/building-codegen/making-codegen-pluggable.html">Making Codegen Pluggable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/building-codegen/generating-code.html">Generating Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/building-codegen/decoupling-codegen-with-symbols.html">Decoupling Codegen with Symbols</a></li>
<li class="toctree-l3"><a class="reference internal" href="../guides/building-codegen/using-the-semantic-model.html">Using the Semantic Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../guides/glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../additional-specs/index.html">Additional specs</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../additional-specs/http-protocol-compliance-tests.html">HTTP Protocol Compliance Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../additional-specs/smoke-tests.html">Smoke Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../additional-specs/waiters.html">Waiters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../additional-specs/mqtt.html">MQTT Protocol Bindings</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../additional-specs/rules-engine/index.html">Rules engine</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../additional-specs/rules-engine/specification.html">Rules engine specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../additional-specs/rules-engine/parameters.html">Rules engine parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../additional-specs/rules-engine/standard-library.html">Rules engine standard library</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../aws/index.html">AWS integrations</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../aws/aws-core.html">AWS Core Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aws/aws-auth.html">AWS Authentication Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aws/aws-endpoints-region.html">AWS Declarative Endpoint Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aws/aws-iam.html">AWS IAM traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aws/amazon-apigateway.html">Amazon API Gateway traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../aws/aws-cloudformation.html">AWS CloudFormation Traits</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../aws/protocols/index.html">AWS Protocols</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../aws/protocols/aws-restjson1-protocol.html">AWS restJson1 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/protocols/aws-json-1_0-protocol.html">AWS JSON 1.0 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/protocols/aws-json-1_1-protocol.html">AWS JSON 1.1 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/protocols/aws-restxml-protocol.html">AWS restXml protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/protocols/aws-query-protocol.html">AWS query protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/protocols/aws-ec2-query-protocol.html">AWS EC2 query protocol</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../aws/customizations/index.html">AWS Service Customizations</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../aws/customizations/apigateway-customizations.html">Amazon API Gateway Customizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/customizations/glacier-customizations.html">Amazon Glacier Customizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/customizations/machinelearning-customizations.html">Amazon Machine Learning Customizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/customizations/s3-customizations.html">Amazon S3 Customizations</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../aws/rules-engine/index.html">AWS rules engine extensions</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../aws/rules-engine/built-ins.html">AWS rules engine built-ins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/rules-engine/library-functions.html">AWS rules engine library functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../aws/rules-engine/auth-schemes.html">AWS rules engine authentication scheme validators</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ts-ssdk/index.html">Smithy Server Generator for TypeScript</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ts-ssdk/introduction.html">Introduction to the Smithy Server Generator for TypeScript</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ts-ssdk/handlers.html">Smithy Server Generator for TypeScript handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ts-ssdk/validation.html">Smithy Server Generator for TypeScript validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ts-ssdk/error-handling.html">Smithy Server Generator for TypeScript error handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ts-ssdk/supported-endpoints.html">Smithy Server Generator for TypeScript supported endpoints</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/smithy-lang/smithy">Source code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/smithy-lang/awesome-smithy">Awesome Smithy</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/smithy-lang/smithy-examples">Smithy Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://smithy.io/1.0/">1.0 Documentation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/awslabs/smithy/edit/main/docs/source-2.0/spec/aggregate-types.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="aggregate-types">
<span id="id1"></span><h1><span class="section-number">3. </span>Aggregate types<a class="headerlink" href="#aggregate-types" title="Permalink to this heading">#</a></h1>
<p>Aggregate types contain configurable member references to others shapes.</p>
<div class="section" id="list">
<span id="id2"></span><h2><span class="section-number">3.1. </span>List<a class="headerlink" href="#list" title="Permalink to this heading">#</a></h2>
<p>The <em class="dfn">list</em> type represents an ordered homogeneous collection of values.
A list shape requires a single member named <code class="docutils literal notranslate"><span class="pre">member</span></code>. Lists are defined
in the IDL using a <a class="reference internal" href="idl.html#idl-list"><span class="std std-ref">list_statement</span></a>.
The following example defines a list with a string member from the
<a class="reference internal" href="model.html#prelude"><span class="std std-ref">prelude</span></a>:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">list </span><span class="nc">MyList</span><span class="w"> </span>{
<span class="w">    </span><span class="py">member</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>
}
</pre></div>
</div>
<div class="section" id="list-member-optionality">
<h3><span class="section-number">3.1.1. </span>List member optionality<a class="headerlink" href="#list-member-optionality" title="Permalink to this heading">#</a></h3>
<p>Lists are considered <em>dense</em> by default, meaning they cannot contain <code class="docutils literal notranslate"><span class="pre">null</span></code>
values. A list MAY be made <em>sparse</em> by applying the <a class="reference internal" href="type-refinement-traits.html#sparse-trait"><span class="std std-ref">sparse trait</span></a>. The
following example defines a sparse list:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nt">@sparse</span>
<span class="kd">list </span><span class="nc">SparseList</span><span class="w"> </span>{
<span class="w">    </span><span class="py">member</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>
}
</pre></div>
</div>
</div>
<div class="section" id="list-member-shape-id">
<h3><span class="section-number">3.1.2. </span>List member shape ID<a class="headerlink" href="#list-member-shape-id" title="Permalink to this heading">#</a></h3>
<p>The shape ID of the member of a list is the list shape ID followed by
<code class="docutils literal notranslate"><span class="pre">$member</span></code>. For example, the shape ID of the list member in the above
example is <code class="docutils literal notranslate"><span class="pre">smithy.example#MyList$member</span></code>.</p>
</div>
</div>
<div class="section" id="map">
<span id="id3"></span><h2><span class="section-number">3.2. </span>Map<a class="headerlink" href="#map" title="Permalink to this heading">#</a></h2>
<p>The <em class="dfn">map</em> type represents a map data structure that maps <code class="docutils literal notranslate"><span class="pre">string</span></code>
keys to homogeneous values. A map requires a member named <code class="docutils literal notranslate"><span class="pre">key</span></code>
that MUST target a <code class="docutils literal notranslate"><span class="pre">string</span></code> shape and a member named <code class="docutils literal notranslate"><span class="pre">value</span></code>.
Maps are defined in the IDL using a <a class="reference internal" href="idl.html#idl-map"><span class="std std-ref">map_statement</span></a>.
The following example defines a map of strings to integers:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">map </span><span class="nc">IntegerMap</span><span class="w"> </span>{
<span class="w">    </span><span class="py">key</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>
<span class="w">    </span><span class="py">value</span><span class="p">:</span><span class="w"> </span><span class="vc">Integer</span>
}
</pre></div>
</div>
<div class="section" id="map-member-optionality">
<h3><span class="section-number">3.2.1. </span>Map member optionality<a class="headerlink" href="#map-member-optionality" title="Permalink to this heading">#</a></h3>
<div class="section" id="map-keys-are-never-optional">
<h4><span class="section-number">3.2.1.1. </span>Map keys are never optional<a class="headerlink" href="#map-keys-are-never-optional" title="Permalink to this heading">#</a></h4>
<p>Map keys are not permitted to be <code class="docutils literal notranslate"><span class="pre">null</span></code>. Not all protocol serialization
formats have a way to define <code class="docutils literal notranslate"><span class="pre">null</span></code> map keys, and map implementations
across programming languages often do not allow <code class="docutils literal notranslate"><span class="pre">null</span></code> keys in maps.</p>
</div>
<div class="section" id="map-values-are-always-present-by-default">
<h4><span class="section-number">3.2.1.2. </span>Map values are always present by default<a class="headerlink" href="#map-values-are-always-present-by-default" title="Permalink to this heading">#</a></h4>
<p>Maps values are considered <em>dense</em> by default, meaning they cannot contain
<code class="docutils literal notranslate"><span class="pre">null</span></code> values. A map MAY be made <em>sparse</em> by applying the
<a class="reference internal" href="type-refinement-traits.html#sparse-trait"><span class="std std-ref">sparse trait</span></a>. The following example defines a sparse map:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="nt">@sparse</span>
<span class="kd">map </span><span class="nc">SparseMap</span><span class="w"> </span>{
<span class="w">    </span><span class="py">key</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>
<span class="w">    </span><span class="py">value</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>
}
</pre></div>
</div>
</div>
</div>
<div class="section" id="map-member-shape-ids">
<h3><span class="section-number">3.2.2. </span>Map member shape IDs<a class="headerlink" href="#map-member-shape-ids" title="Permalink to this heading">#</a></h3>
<p>The shape ID of the <code class="docutils literal notranslate"><span class="pre">key</span></code> member of a map is the map shape ID followed by
<code class="docutils literal notranslate"><span class="pre">$key</span></code>, and the shape ID of the <code class="docutils literal notranslate"><span class="pre">value</span></code> member is the map shape ID
followed by <code class="docutils literal notranslate"><span class="pre">$value</span></code>. For example, the shape ID of the <code class="docutils literal notranslate"><span class="pre">key</span></code> member in
the above map is <code class="docutils literal notranslate"><span class="pre">smithy.example#IntegerMap$key</span></code>, and the <code class="docutils literal notranslate"><span class="pre">value</span></code>
member is <code class="docutils literal notranslate"><span class="pre">smithy.example#IntegerMap$value</span></code>.</p>
</div>
</div>
<div class="section" id="structure">
<span id="id4"></span><h2><span class="section-number">3.3. </span>Structure<a class="headerlink" href="#structure" title="Permalink to this heading">#</a></h2>
<p>The <em class="dfn">structure</em> type represents a fixed set of named, unordered,
heterogeneous values. A structure shape contains a set of named members, and
each member name maps to exactly one <a class="reference internal" href="model.html#member"><span class="std std-ref">member</span></a> definition.
Structures are defined in the IDL using a
<a class="reference internal" href="idl.html#idl-structure"><span class="std std-ref">structure_statement</span></a>.</p>
<p>The following example defines a structure with three members, one of which
is marked with the <a class="reference internal" href="type-refinement-traits.html#required-trait"><span class="std std-ref">required trait</span></a>, and one that is marked with the
<a class="reference internal" href="type-refinement-traits.html#default-trait"><span class="std std-ref">default trait</span></a> using IDL syntactic sugar.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">structure </span><span class="nc">MyStructure</span><span class="w"> </span>{
<span class="w">    </span><span class="py">foo</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>

<span class="w">    </span><span class="nt">@required</span>
<span class="w">    </span><span class="py">baz</span><span class="p">:</span><span class="w"> </span><span class="vc">Integer</span>

<span class="w">    </span><span class="py">greeting</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;Hello&quot;</span>
}
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="idl.html#idl-applying-traits"><span class="std std-ref">Applying traits</span></a> for a description of how to apply traits.</li>
<li><a class="reference internal" href="mixins.html"><span class="doc">Mixins</span></a> to reduce structure duplication</li>
<li><a class="reference internal" href="idl.html#idl-target-elision"><span class="std std-ref">Target Elision</span></a> to define members that inherit target from
resources or mixins.</li>
</ul>
</div>
<div class="section" id="adding-new-structure-members">
<h3><span class="section-number">3.3.1. </span>Adding new structure members<a class="headerlink" href="#adding-new-structure-members" title="Permalink to this heading">#</a></h3>
<p>Members MAY be added to structures. New members MUST NOT be marked with the
<a class="reference internal" href="type-refinement-traits.html#required-trait"><span class="std std-ref">required trait</span></a>. New members SHOULD be added to the end of the
structure. This ensures that programming languages that require a specific
data structure layout or alignment for code generated from Smithy models are
able to maintain backward compatibility.</p>
</div>
<div class="section" id="structure-member-shape-ids">
<h3><span class="section-number">3.3.2. </span>Structure member shape IDs<a class="headerlink" href="#structure-member-shape-ids" title="Permalink to this heading">#</a></h3>
<p>The shape ID of a member of a structure is the structure shape ID, followed
by <code class="docutils literal notranslate"><span class="pre">$</span></code>, followed by the member name. For example, the shape ID of the <code class="docutils literal notranslate"><span class="pre">foo</span></code>
member in the above example is <code class="docutils literal notranslate"><span class="pre">smithy.example#MyStructure$foo</span></code>.</p>
</div>
<div class="section" id="structure-member-optionality">
<span id="structure-optionality"></span><h3><span class="section-number">3.3.3. </span>Structure member optionality<a class="headerlink" href="#structure-member-optionality" title="Permalink to this heading">#</a></h3>
<p>Whether a structure member is optional is determined by evaluating the
<a class="reference internal" href="type-refinement-traits.html#required-trait"><span class="std std-ref">required trait</span></a>, <a class="reference internal" href="type-refinement-traits.html#default-trait"><span class="std std-ref">default trait</span></a>, <a class="reference internal" href="type-refinement-traits.html#clientoptional-trait"><span class="std std-ref">clientOptional trait</span></a>,
<a class="reference internal" href="type-refinement-traits.html#input-trait"><span class="std std-ref">input trait</span></a>, and <a class="reference internal" href="type-refinement-traits.html#addeddefault-trait"><span class="std std-ref">addedDefault trait</span></a>. Authoritative model
consumers like servers MAY choose to determine optionality using more
restrictive rules by ignoring the <code class="docutils literal notranslate"><span class="pre">&#64;input</span></code> and <code class="docutils literal notranslate"><span class="pre">&#64;clientOptional</span></code> traits.</p>
<div class="table-wrapper colwidths-given docutils container">
<table border="1" class="docutils align-default">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Trait</th>
<th class="head">Authoritative</th>
<th class="head">Non-Authoritative</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="type-refinement-traits.html#clientoptional-trait"><span class="std std-ref">&#64;clientOptional</span></a></td>
<td>Ignored</td>
<td>Optional regardless of the <code class="docutils literal notranslate"><span class="pre">&#64;required</span></code> or <code class="docutils literal notranslate"><span class="pre">&#64;default</span></code> trait</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="type-refinement-traits.html#input-trait"><span class="std std-ref">&#64;input</span></a></td>
<td>Ignored</td>
<td>All members are optional regardless of the <code class="docutils literal notranslate"><span class="pre">&#64;required</span></code> or <code class="docutils literal notranslate"><span class="pre">&#64;default</span></code> trait</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="type-refinement-traits.html#required-trait"><span class="std std-ref">&#64;required</span></a></td>
<td>Present</td>
<td>Present unless also <code class="docutils literal notranslate"><span class="pre">&#64;clientOptional</span></code> or part of an <code class="docutils literal notranslate"><span class="pre">&#64;input</span></code> structure</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="type-refinement-traits.html#default-trait"><span class="std std-ref">&#64;default</span></a></td>
<td>Present</td>
<td>Present unless also <code class="docutils literal notranslate"><span class="pre">&#64;clientOptional</span></code> or part of an <code class="docutils literal notranslate"><span class="pre">&#64;input</span></code> structure</td>
</tr>
<tr class="row-even"><td>(Other members)</td>
<td>Optional</td>
<td>Optional</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="required-members">
<h4><span class="section-number">3.3.3.1. </span>Required members<a class="headerlink" href="#required-members" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="type-refinement-traits.html#required-trait"><span class="std std-ref">required trait</span></a> indicates that a value MUST always be present for a
member in order to create a valid structure. Code generators SHOULD generate
accessors for these members that always return a value.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">structure </span><span class="nc">TimeSpan</span><span class="w"> </span>{
<span class="w">    </span><span class="c">// years must always be present to make a TimeSpan</span>
<span class="w">    </span><span class="nt">@required</span>
<span class="w">    </span><span class="py">years</span><span class="p">:</span><span class="w"> </span><span class="vc">Integer</span>
}
</pre></div>
</div>
<div class="section" id="client-error-correction">
<h5><span class="section-number">3.3.3.1.1. </span>Client error correction<a class="headerlink" href="#client-error-correction" title="Permalink to this heading">#</a></h5>
<p>If a mis-configured server fails to serialize a value for a required member,
to avoid downtime, clients MAY attempt to fill in an appropriate default value
for the member:</p>
<ul class="simple">
<li>boolean: false</li>
<li>numbers: 0</li>
<li>timestamp: 0 seconds since the Unix epoch</li>
<li>string: &quot;&quot;</li>
<li>blob: empty bytes</li>
<li>document: null</li>
<li>list: []</li>
<li>map: {}</li>
<li>enum, intEnum, union: The unknown variant. These types SHOULD define an
unknown variant to account for receiving unknown members.</li>
<li>union: The unknown variant. Code generators for unions SHOULD define an
unknown variant to account for newly added members.</li>
<li>structure: {} if possible, otherwise a deserialization error.</li>
</ul>
</div>
</div>
<div class="section" id="default-values">
<h4><span class="section-number">3.3.3.2. </span>Default values<a class="headerlink" href="#default-values" title="Permalink to this heading">#</a></h4>
<p>The <a class="reference internal" href="type-refinement-traits.html#default-trait"><span class="std std-ref">default trait</span></a> gives a structure member a default value. The
following example uses syntactic sugar in the Smithy IDL allows to assign
a default value to the <code class="docutils literal notranslate"><span class="pre">days</span></code> member.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">structure </span><span class="nc">TimeSpan</span><span class="w"> </span>{
<span class="w">    </span><span class="nt">@required</span>
<span class="w">    </span><span class="py">years</span><span class="p">:</span><span class="w"> </span><span class="vc">Integer</span>

<span class="w">    </span><span class="py">days</span><span class="p">:</span><span class="w"> </span><span class="vc">Integer</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m">0</span>
}
</pre></div>
</div>
</div>
<div class="section" id="evolving-requirements-and-members">
<h4><span class="section-number">3.3.3.3. </span>Evolving requirements and members<a class="headerlink" href="#evolving-requirements-and-members" title="Permalink to this heading">#</a></h4>
<p>Requirements change; what is required today might not be required tomorrow.
Smithy provides several ways to make it so that required members no longer
need to be provided without breaking previously generated code.</p>
<div class="section" id="migrating-required-to-default">
<h5><span class="section-number">3.3.3.3.1. </span>Migrating <code class="docutils literal notranslate"><span class="pre">&#64;required</span></code> to <code class="docutils literal notranslate"><span class="pre">&#64;default</span></code><a class="headerlink" href="#migrating-required-to-default" title="Permalink to this heading">#</a></h5>
<p>If a <code class="docutils literal notranslate"><span class="pre">required</span></code> member no longer needs to be be required, the <code class="docutils literal notranslate"><span class="pre">required</span></code>
trait MAY be removed and replaced with the <a class="reference internal" href="type-refinement-traits.html#default-trait"><span class="std std-ref">default trait</span></a>. Alternatively,
a <code class="docutils literal notranslate"><span class="pre">default</span></code> trait MAY be added to a member marked as <code class="docutils literal notranslate"><span class="pre">required</span></code> to
provide a default value for the member but require that it is serialized.
Either way, the member is still considered always present to tools like code
generators, but instead of requiring the value to be provided by an end-user,
a default value is automatically provided if missing. For example, the previous
<code class="docutils literal notranslate"><span class="pre">TimeSpan</span></code> model can be backward compatibly changed to:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">structure </span><span class="nc">TimeSpan</span><span class="w"> </span>{
<span class="w">    </span><span class="c">// @required is replaced with @default and @addedDefault</span>
<span class="w">    </span><span class="nt">@addedDefault</span>
<span class="w">    </span><span class="py">years</span><span class="p">:</span><span class="w"> </span><span class="vc">Integer</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="py">days</span><span class="p">:</span><span class="w"> </span><span class="vc">Integer</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m">0</span>
}
</pre></div>
</div>
<p>The <a class="reference internal" href="type-refinement-traits.html#addeddefault-trait"><span class="std std-ref">addedDefault trait</span></a> trait SHOULD be used any time a <code class="docutils literal notranslate"><span class="pre">default</span></code> trait is
added to a previously published member. Some tooling does not treat the
<code class="docutils literal notranslate"><span class="pre">required</span></code> trait as non-nullable but does treat the <code class="docutils literal notranslate"><span class="pre">default</span></code> trait as
non-nullable.</p>
</div>
<div class="section" id="requiring-members-to-be-optional">
<h5><span class="section-number">3.3.3.3.2. </span>Requiring members to be optional<a class="headerlink" href="#requiring-members-to-be-optional" title="Permalink to this heading">#</a></h5>
<p>The <a class="reference internal" href="type-refinement-traits.html#clientoptional-trait"><span class="std std-ref">clientOptional trait</span></a> is used to indicate that a member that is
currently required by authoritative model consumers like servers MAY become
completely optional in the future. Non-authoritative model consumers like
client code generators MUST treat the member as if it is not required and
has no default value. Authoritative model consumers MAY choose to ignore
the <code class="docutils literal notranslate"><span class="pre">clientOptional</span></code> trait.</p>
<p>For example, the following structure:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">structure </span><span class="nc">UserData</span><span class="w"> </span>{
<span class="w">    </span><span class="nt">@required</span>
<span class="w">    </span><span class="nt">@clientOptional</span>
<span class="w">    </span><span class="py">summary</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>
}
</pre></div>
</div>
<p>Can be backward-compatibly updated to remove the <code class="docutils literal notranslate"><span class="pre">required</span></code> trait:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">structure </span><span class="nc">UserData</span><span class="w"> </span>{
<span class="w">    </span><span class="py">summary</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>
}
</pre></div>
</div>
<p>Replacing both the <code class="docutils literal notranslate"><span class="pre">required</span></code> and <code class="docutils literal notranslate"><span class="pre">clientOptional</span></code> trait with the <code class="docutils literal notranslate"><span class="pre">default</span></code>
trait is <em>not</em> a backward compatible change because model consumers would
transition from assuming the value is optional to assuming that it is always
present due to a default value.</p>
</div>
<div class="section" id="model-evolution-and-the-input-trait">
<h5><span class="section-number">3.3.3.3.3. </span>Model evolution and the <code class="docutils literal notranslate"><span class="pre">&#64;input</span></code> trait<a class="headerlink" href="#model-evolution-and-the-input-trait" title="Permalink to this heading">#</a></h5>
<p>The <a class="reference internal" href="type-refinement-traits.html#input-trait"><span class="std std-ref">input trait</span></a> specializes a structure as the input of a single
operation. Transitioning top-level members from <code class="docutils literal notranslate"><span class="pre">required</span></code> to optional is
allowed for such structures because it is loosening an input constraint.
Non-authoritative model consumers like clients MUST treat each member as
nullable regardless of the <code class="docutils literal notranslate"><span class="pre">required</span></code> or <code class="docutils literal notranslate"><span class="pre">default</span></code> trait. This means that
it is a backward compatible change to remove the <code class="docutils literal notranslate"><span class="pre">required</span></code> trait from a
member of a structure marked with the <code class="docutils literal notranslate"><span class="pre">input</span></code> trait, and the <code class="docutils literal notranslate"><span class="pre">default</span></code>
trait does not need to be added in its place.</p>
<p>The special &quot;:=&quot; syntax for the operation input property automatically applies
the <code class="docutils literal notranslate"><span class="pre">input</span></code> trait:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">operation </span><span class="nc">PutTimeSpan</span><span class="w"> </span>{
<span class="w">    </span><span class="py">input</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span>{
<span class="w">        </span><span class="nt">@required</span>
<span class="w">        </span><span class="py">years</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>
<span class="w">    </span>}
}
</pre></div>
</div>
<p>Because of the <code class="docutils literal notranslate"><span class="pre">input</span></code> trait, the operation can be updated to remove the
<code class="docutils literal notranslate"><span class="pre">required</span></code> trait without breaking things like previously generated clients:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">operation </span><span class="nc">PutTimeSpan</span><span class="w"> </span>{
<span class="w">    </span><span class="py">input</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span>{
<span class="w">        </span><span class="py">years</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span>
<span class="w">    </span>}
}
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="union">
<span id="id5"></span><h2><span class="section-number">3.4. </span>Union<a class="headerlink" href="#union" title="Permalink to this heading">#</a></h2>
<p>The union type represents a <a class="reference external" href="https://en.wikipedia.org/wiki/Tagged_union">tagged union data structure</a> that can take
on several different, but fixed, types. Unions function similarly to
structures except that only one member can be used at any one time. Each
member in the union is a variant of the tagged union, where member names
are the tags of each variant, and the shapes targeted by members are the
values of each variant.</p>
<p>Unions are defined in the IDL using a <a class="reference internal" href="idl.html#idl-union"><span class="std std-ref">union_statement</span></a>.
A union shape MUST contain one or more named <a class="reference internal" href="model.html#member"><span class="std std-ref">members</span></a>.
The following example defines a union shape with several members:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">union </span><span class="nc">MyUnion</span><span class="w"> </span>{
<span class="w">    </span><span class="py">i32</span><span class="p">:</span><span class="w"> </span><span class="vc">Integer</span>

<span class="w">    </span><span class="nt">@length</span>(<span class="py">min</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="py">max</span><span class="p">:</span><span class="w"> </span><span class="m">100</span>)
<span class="w">    </span><span class="py">string</span><span class="p">:</span><span class="w"> </span><span class="vc">String</span><span class="p">,</span>

<span class="w">    </span><span class="py">time</span><span class="p">:</span><span class="w"> </span><span class="vc">Timestamp</span><span class="p">,</span>
}
</pre></div>
</div>
<div class="section" id="unit-types-in-unions">
<h3><span class="section-number">3.4.1. </span>Unit types in unions<a class="headerlink" href="#unit-types-in-unions" title="Permalink to this heading">#</a></h3>
<p>Some union members might not need any meaningful information beyond the
tag itself. For these cases, union members MAY target Smithy's built-in
<a class="reference internal" href="model.html#unit-type"><span class="std std-ref">unit type</span></a>, <code class="docutils literal notranslate"><span class="pre">smithy.api#Unit</span></code>.</p>
<p>The following example defines a union for actions a player can take in a
game.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">union </span><span class="nc">PlayerAction</span><span class="w"> </span>{
<span class="w">    </span><span class="c">/// Quit the game.</span>
<span class="w">    </span><span class="py">quit</span><span class="p">:</span><span class="w"> </span><span class="vc">Unit</span><span class="p">,</span>

<span class="w">    </span><span class="c">/// Move in a specific direction.</span>
<span class="w">    </span><span class="py">move</span><span class="p">:</span><span class="w"> </span><span class="vc">DirectedAction</span><span class="p">,</span>

<span class="w">    </span><span class="c">/// Jump in a specific direction.</span>
<span class="w">    </span><span class="py">jump</span><span class="p">:</span><span class="w"> </span><span class="vc">DirectedAction</span>
}

<span class="kd">structure </span><span class="nc">DirectedAction</span><span class="w"> </span>{
<span class="w">    </span><span class="nt">@required</span>
<span class="w">    </span><span class="py">direction</span><span class="p">:</span><span class="w"> </span><span class="vc">Integer</span>
}
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">quit</span></code> action has no meaningful data associated with it, while <code class="docutils literal notranslate"><span class="pre">move</span></code>
and <code class="docutils literal notranslate"><span class="pre">jump</span></code> both reference <code class="docutils literal notranslate"><span class="pre">DirectedAction</span></code>.</p>
</div>
<div class="section" id="union-member-presence">
<h3><span class="section-number">3.4.2. </span>Union member presence<a class="headerlink" href="#union-member-presence" title="Permalink to this heading">#</a></h3>
<p>Exactly one member of a union MUST be set. The serialization of a union is
defined by a <a class="reference internal" href="protocol-traits.html#protocoldefinition-trait"><span class="std std-ref">protocol</span></a>, but for example
purposes, if unions were to be represented in a hypothetical JSON
serialization, the following value would be valid for the <code class="docutils literal notranslate"><span class="pre">PlayerAction</span></code>
union because a single member is present:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;move&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;direction&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following value is <strong>invalid</strong> because multiple members are present:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;quit&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">    </span><span class="nt">&quot;move&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;direction&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following value is <strong>invalid</strong> because no members are present:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{}</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-new-union-members">
<h3><span class="section-number">3.4.3. </span>Adding new union members<a class="headerlink" href="#adding-new-union-members" title="Permalink to this heading">#</a></h3>
<p>New members added to existing unions SHOULD be added to the end of the
union. This ensures that programming languages that require a specific
data structure layout or alignment for code generated from Smithy models are
able to maintain backward compatibility.</p>
</div>
<div class="section" id="union-member-shape-ids">
<h3><span class="section-number">3.4.4. </span>Union member shape IDs<a class="headerlink" href="#union-member-shape-ids" title="Permalink to this heading">#</a></h3>
<p>The shape ID of a member of a union is the union shape ID, followed
by <code class="docutils literal notranslate"><span class="pre">$</span></code>, followed by the member name. For example, the shape ID of the <code class="docutils literal notranslate"><span class="pre">i32</span></code>
member in the above example is <code class="docutils literal notranslate"><span class="pre">smithy.example#MyUnion$i32</span></code>.</p>
</div>
</div>
<div class="section" id="recursive-shape-definitions">
<span id="id6"></span><h2><span class="section-number">3.5. </span>Recursive shape definitions<a class="headerlink" href="#recursive-shape-definitions" title="Permalink to this heading">#</a></h2>
<p>Smithy allows recursive shape definitions with the following limitations:</p>
<ol class="arabic simple">
<li>The member of a list or map cannot directly or transitively target
its containing shape unless one or more members in the path from the
container back to itself targets a structure or union shape. This ensures
that shapes that are typically impossible to define in various programming
languages are not defined in Smithy models (for example, you can't define
a recursive list in Java <code class="docutils literal notranslate"><span class="pre">List&lt;List&lt;List....</span></code>).</li>
<li>To ensure a value can be provided for a structure, recursive member
relationship from a structure back to itself MUST NOT be made up of all
<a class="reference internal" href="type-refinement-traits.html#required-trait"><span class="std std-ref">required</span></a> structure members.</li>
<li>To ensure a value can be provided for a union, recursive unions MUST
contain at least one path through its members that is not recursive
or steps through a list, map, or optional structure member.</li>
</ol>
<p>The following recursive shape definition is <strong>valid</strong>:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">list </span><span class="nc">ValidList</span><span class="w"> </span>{
<span class="w">    </span><span class="py">member</span><span class="p">:</span><span class="w"> </span><span class="vc">IntermediateStructure</span>
}

<span class="kd">structure </span><span class="nc">IntermediateStructure</span><span class="w"> </span>{
<span class="w">    </span><span class="py">foo</span><span class="p">:</span><span class="w"> </span><span class="vc">ValidList</span>
}
</pre></div>
</div>
<p>The following recursive shape definition is <strong>invalid</strong>:</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">list </span><span class="nc">RecursiveList</span><span class="w"> </span>{
<span class="w">    </span><span class="py">member</span><span class="p">:</span><span class="w"> </span><span class="vc">RecursiveList</span>
}
</pre></div>
</div>
<p>The following recursive shape definition is <strong>invalid</strong> due to mutual
recursion and the <a class="reference internal" href="type-refinement-traits.html#required-trait"><span class="std std-ref">required trait</span></a>.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>
<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">structure </span><span class="nc">RecursiveShape1</span><span class="w"> </span>{
<span class="w">    </span><span class="nt">@required</span>
<span class="w">    </span><span class="py">recursiveMember</span><span class="p">:</span><span class="w"> </span><span class="vc">RecursiveShape2</span>
}

<span class="kd">structure </span><span class="nc">RecursiveShape2</span><span class="w"> </span>{
<span class="w">    </span><span class="nt">@required</span>
<span class="w">    </span><span class="py">recursiveMember</span><span class="p">:</span><span class="w"> </span><span class="vc">RecursiveShape1</span>
}
</pre></div>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="service-types.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><span class="section-number">4. </span>Service types</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="simple-types.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><span class="section-number">2. </span>Simple types</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Amazon Web Services
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/awslabs/smithy" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">3. Aggregate types</a><ul>
<li><a class="reference internal" href="#list">3.1. List</a><ul>
<li><a class="reference internal" href="#list-member-optionality">3.1.1. List member optionality</a></li>
<li><a class="reference internal" href="#list-member-shape-id">3.1.2. List member shape ID</a></li>
</ul>
</li>
<li><a class="reference internal" href="#map">3.2. Map</a><ul>
<li><a class="reference internal" href="#map-member-optionality">3.2.1. Map member optionality</a><ul>
<li><a class="reference internal" href="#map-keys-are-never-optional">3.2.1.1. Map keys are never optional</a></li>
<li><a class="reference internal" href="#map-values-are-always-present-by-default">3.2.1.2. Map values are always present by default</a></li>
</ul>
</li>
<li><a class="reference internal" href="#map-member-shape-ids">3.2.2. Map member shape IDs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#structure">3.3. Structure</a><ul>
<li><a class="reference internal" href="#adding-new-structure-members">3.3.1. Adding new structure members</a></li>
<li><a class="reference internal" href="#structure-member-shape-ids">3.3.2. Structure member shape IDs</a></li>
<li><a class="reference internal" href="#structure-member-optionality">3.3.3. Structure member optionality</a><ul>
<li><a class="reference internal" href="#required-members">3.3.3.1. Required members</a><ul>
<li><a class="reference internal" href="#client-error-correction">3.3.3.1.1. Client error correction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#default-values">3.3.3.2. Default values</a></li>
<li><a class="reference internal" href="#evolving-requirements-and-members">3.3.3.3. Evolving requirements and members</a><ul>
<li><a class="reference internal" href="#migrating-required-to-default">3.3.3.3.1. Migrating <code class="docutils literal notranslate"><span class="pre">&#64;required</span></code> to <code class="docutils literal notranslate"><span class="pre">&#64;default</span></code></a></li>
<li><a class="reference internal" href="#requiring-members-to-be-optional">3.3.3.3.2. Requiring members to be optional</a></li>
<li><a class="reference internal" href="#model-evolution-and-the-input-trait">3.3.3.3.3. Model evolution and the <code class="docutils literal notranslate"><span class="pre">&#64;input</span></code> trait</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#union">3.4. Union</a><ul>
<li><a class="reference internal" href="#unit-types-in-unions">3.4.1. Unit types in unions</a></li>
<li><a class="reference internal" href="#union-member-presence">3.4.2. Union member presence</a></li>
<li><a class="reference internal" href="#adding-new-union-members">3.4.3. Adding new union members</a></li>
<li><a class="reference internal" href="#union-member-shape-ids">3.4.4. Union member shape IDs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#recursive-shape-definitions">3.5. Recursive shape definitions</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    </body>
</html>