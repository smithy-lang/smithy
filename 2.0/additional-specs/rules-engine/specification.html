<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html"><link rel="next" title="Rules engine parameters" href="parameters.html"><link rel="prev" title="Rules engine" href="index.html">
        <link rel="prefetch" href="../../_static/smithy.svg" as="image">
        <link rel="prefetch" href="../../_static/smithy-dark.svg" as="image">

    <link rel="shortcut icon" href="../../_static/favicon.svg"><!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>Rules engine specification - Smithy 2.0</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=0abfef4d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 100%;
  --admonition-title-font-size: 100%;
  --color-brand-primary: #C44536;
  --color-brand-content: #00808b;
  --color-announcement-background: #f8f8f8;
  --color-announcement-text: #383838;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #282828;
  --color-code-foreground: #dddddd;
  --color-brand-primary: #ed9d13;
  --color-brand-content: #58d3ff;
  --color-announcement-background: ##1a1c1e;;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #282828;
  --color-code-foreground: #dddddd;
  --color-brand-primary: #ed9d13;
  --color-brand-content: #58d3ff;
  --color-announcement-background: ##1a1c1e;;
  
      }
    }
  }
</style><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js"></script>
<script src="https://d2c.aws.amazon.com/client/loader/v1/d2c-load.js"></script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Smithy 2.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="/index.html">
  
  <div class="sidebar-brand-icon">
    <img class="sidebar-logo only-light" src="../../_static/smithy.svg" alt="Logo">
    <img class="sidebar-logo only-dark" src="../../_static/smithy-dark.svg" alt="Logo">
  </div>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick start</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../spec/index.html">Smithy specification</a><input aria-label="Toggle navigation of Smithy specification" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../spec/model.html">1. The Smithy model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/simple-types.html">2. Simple types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/aggregate-types.html">3. Aggregate types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/service-types.html">4. Service types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/mixins.html">5. Mixins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/constraint-traits.html">6. Constraint traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/type-refinement-traits.html">7. Type refinement traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/documentation-traits.html">8. Documentation traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/behavior-traits.html">9. Behavior traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/resource-traits.html">10. Resource traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/authentication-traits.html">11. Authentication traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/protocol-traits.html">12. Serialization and Protocol traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/streaming.html">13. Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/http-bindings.html">14. HTTP bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/endpoint-traits.html">15. Endpoint traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/selectors.html">16. Selectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/model-validation.html">17. Model validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/idl.html">18. Smithy IDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/json-ast.html">19. JSON AST</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../trait-index.html">Trait index</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../guides/index.html">Guides</a><input aria-label="Toggle navigation of Guides" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/smithy-cli/index.html">The Smithy CLI</a><input aria-label="Toggle navigation of The Smithy CLI" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/smithy-cli/cli_installation.html">Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/smithy-build-json.html">smithy-build.json</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/gradle-plugin/index.html">Smithy Gradle Plugins</a><input aria-label="Toggle navigation of Smithy Gradle Plugins" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/gradle-plugin/gradle-migration-guide.html">Migrating to Gradle plugin version 0.10.0+</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/using-code-generation/index.html">Code Generation</a><input aria-label="Toggle navigation of Code Generation" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/using-code-generation/update-model.html">Updating the Smithy Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/using-code-generation/generating-a-client.html">Generating a client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/model-linters.html">Linting Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/model-validation-examples.html">Model Validation Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/evolving-models.html">Evolving Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/wire-protocol-selection.html">Wire protocol selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/style-guide.html">Style Guide</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/model-translations/index.html">Model Translations</a><input aria-label="Toggle navigation of Model Translations" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/model-translations/converting-to-openapi.html">Converting Smithy to OpenAPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/model-translations/migrating-idl-1-to-2.html">Smithy IDL 1.0 to 2.0 Migration Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/model-translations/generating-cloudformation-resources.html">Generating CloudFormation Resource Schemas from Smithy</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/building-codegen/index.html">Creating a Code Generator</a><input aria-label="Toggle navigation of Creating a Code Generator" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/overview-and-concepts.html">Overview and Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/mapping-shapes-to-languages.html">Mapping Smithy Shapes to Your Language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/creating-codegen-repo.html">Creating a Codegen Repo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/configuring-the-generator.html">Configuring the Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/implementing-the-generator.html">Implementing the Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/making-codegen-pluggable.html">Making Codegen Pluggable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/generating-code.html">Generating Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/decoupling-codegen-with-symbols.html">Decoupling Codegen with Symbols</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/using-the-semantic-model.html">Using the Semantic Model</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/client-guidance/index.html">Smithy Client Guidance</a><input aria-label="Toggle navigation of Smithy Client Guidance" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../guides/client-guidance/application-protocols/index.html">Application Protocols</a><input aria-label="Toggle navigation of Application Protocols" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../guides/client-guidance/application-protocols/http.html">HTTP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/client-guidance/context.html">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/client-guidance/retries.html">Retrying Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/client-guidance/endpoints.html">Endpoint Resolution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/full-stack-tutorial.html">Full Stack Application</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Additional specs</a><input aria-label="Toggle navigation of Additional specs" checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ai-traits.html">Smithy AI Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contract-traits.html">Contract traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../http-protocol-compliance-tests.html">HTTP Protocol Compliance Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../event-stream-protocol-compliance-tests.html">Event Stream Protocol Compliance Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../smoke-tests.html">Smoke Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../waiters.html">Waiters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mqtt.html">MQTT Protocol Bindings</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Rules engine</a><input aria-label="Toggle navigation of Rules engine" checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Rules engine specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameters.html">Rules engine parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="standard-library.html">Rules engine standard library</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../protocols/index.html">Protocols</a><input aria-label="Toggle navigation of Protocols" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../protocols/smithy-rpc-v2.html">Smithy RPC v2 CBOR protocol</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../aws/index.html">AWS integrations</a><input aria-label="Toggle navigation of AWS integrations" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-core.html">AWS Core Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-auth.html">AWS Authentication Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-endpoints-region.html">AWS Declarative Endpoint Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-iam.html">AWS IAM traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/amazon-apigateway.html">Amazon API Gateway traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-cloudformation.html">AWS CloudFormation Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/amazon-eventstream.html">Amazon Event Stream Specification</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../aws/protocols/index.html">AWS Protocols</a><input aria-label="Toggle navigation of AWS Protocols" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-restjson1-protocol.html">AWS restJson1 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-json-1_0-protocol.html">AWS JSON 1.0 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-json-1_1-protocol.html">AWS JSON 1.1 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-restxml-protocol.html">AWS restXml protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-query-protocol.html">AWS query protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-ec2-query-protocol.html">AWS EC2 query protocol</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../aws/customizations/index.html">AWS Service Customizations</a><input aria-label="Toggle navigation of AWS Service Customizations" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../aws/customizations/apigateway-customizations.html">Amazon API Gateway Customizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/customizations/glacier-customizations.html">Amazon Glacier Customizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/customizations/machinelearning-customizations.html">Amazon Machine Learning Customizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/customizations/s3-customizations.html">Amazon S3 Customizations</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../aws/rules-engine/index.html">AWS rules engine extensions</a><input aria-label="Toggle navigation of AWS rules engine extensions" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../aws/rules-engine/built-ins.html">AWS rules engine built-ins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/rules-engine/library-functions.html">AWS rules engine library functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/rules-engine/auth-schemes.html">AWS rules engine authentication scheme validators</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Languages</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/java/index.html">Java</a><input aria-label="Toggle navigation of Java" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../languages/java/quickstart.html">Java Quickstart</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../languages/java/client/index.html">Client User Guide</a><input aria-label="Toggle navigation of Client User Guide" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/generating-clients.html">Generating Clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/configuration.html">Configuring Clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/customization.html">Customizing Client Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/plugins.html">Client Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/dynamic-client.html">Dynamic Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/codegen-integrations.html">Codegen Integrations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-java">Source code</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-java/tree/0.0.3/examples">Smithy Java Examples</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/typescript/index.html">TypeScript</a><input aria-label="Toggle navigation of TypeScript" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../languages/typescript/quickstart.html">TypeScript Quickstart</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../languages/typescript/ts-ssdk/index.html">Server Generator for TypeScript</a><input aria-label="Toggle navigation of Server Generator for TypeScript" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/introduction.html">Introduction to the Smithy Server Generator for TypeScript</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/handlers.html">Smithy Server Generator for TypeScript handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/validation.html">Smithy Server Generator for TypeScript validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/error-handling.html">Smithy Server Generator for TypeScript error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/supported-endpoints.html">Smithy Server Generator for TypeScript supported endpoints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-typescript">Source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/full-stack-tutorial.html">Smithy Full Stack Application</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/rust/index.html">Rust</a><input aria-label="Toggle navigation of Rust" class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://smithy-lang.github.io/smithy-rs/design/">Design Documentation</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-rs">Source code</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/python/index.html">Python</a><input aria-label="Toggle navigation of Python" class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-python">Source code</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/kotlin/index.html">Kotlin</a><input aria-label="Toggle navigation of Kotlin" class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../languages/kotlin/quickstart.html">Kotlin Quickstart</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../languages/kotlin/client/index.html">Client User Guide</a><input aria-label="Toggle navigation of Client User Guide" class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../languages/kotlin/client/generating-clients.html">Generating Clients</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-kotlin">Source code</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-examples/tree/main/smithy-kotlin-examples">Smithy Kotlin Examples</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-kotlin/tree/main/docs/design">Smithy Kotlin Design Docs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/golang/index.html">GoLang</a><input aria-label="Toggle navigation of GoLang" class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://github.com/aws/smithy-go">Source code</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/scala/index.html">Scala</a><input aria-label="Toggle navigation of Scala" class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://disneystreaming.github.io/smithy4s/">Documentation</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/disneystreaming/smithy4s">Source code</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/smithy-lang/smithy">Source code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/smithy-lang/awesome-smithy">Awesome Smithy</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/smithy-lang/smithy-examples">Smithy Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://smithy.io/1.0/">1.0 Documentation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/smithy-lang/smithy/blob/main/docs/source-2.0/additional-specs/rules-engine/specification.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/smithy-lang/smithy/edit/main/docs/source-2.0/additional-specs/rules-engine/specification.rst" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="rules-engine-specification">
<span id="id1"></span><h1>Rules engine specification<a class="headerlink" href="#rules-engine-specification" title="Link to this heading">¶</a></h1>
<p>The Smithy rules engine provides service owners with a collection of traits
and components to define rule sets. Rule sets can be consumed by code
generators to provide the rule set's specific functionality.</p>
<p>A rule set defines zero or more <em>parameters</em> and one or more <em>rules</em>.
Parameters define the primary set of values that a rule set operates on. Rules
are composed of a set of <em>conditions</em>, which determine if a rule should be
selected, and a result. Conditions act on the defined parameters, and allow for
the modeling of statements.</p>
<p>When a rule's conditions are evaluated successfully, the rule provides either a
result and its accompanying requirements or an error describing the unsupported
state. Modeled endpoint errors allow for more explicit descriptions to users,
such as providing errors when a service doesn't support a combination of
conditions.</p>
<section id="rules-engine-version">
<h2>Rules engine version<a class="headerlink" href="#rules-engine-version" title="Link to this heading">¶</a></h2>
<p>The rules engine specification is versioned, with the current version being 1.1. Unless otherwise specified, functions,
features, and built-ins have been available since version 1.0. Any feature, function, or built-in used in the
<code class="docutils literal notranslate"><span class="pre">endpointRuleSet</span></code> or <code class="docutils literal notranslate"><span class="pre">endpointBdd</span></code> traits MUST be supported by the declared version of the trait. In other words,
the feature's introduction version must be less than or equal to the trait version.</p>
</section>
<section id="smithy-rules-endpointruleset-trait">
<span id="smithy-rules-endpointruleset-trait"></span><span id="id2"></span><h2><code class="docutils literal notranslate"><span class="pre">smithy.rules#endpointRuleSet</span></code> trait<a class="headerlink" href="#smithy-rules-endpointruleset-trait" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>Summary</dt><dd><p>Defines a rule set for deriving service endpoints at runtime.</p>
</dd>
<dt>Trait selector</dt><dd><p><code class="docutils literal notranslate"><span class="pre">service</span></code></p>
</dd>
<dt>Value type</dt><dd><p><code class="docutils literal notranslate"><span class="pre">document</span></code></p>
</dd>
</dl>
<p>The content of the <code class="docutils literal notranslate"><span class="pre">endpointRuleSet</span></code> document has the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 30.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>version</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. The rules engine version (e.g., 1.0).</p></td>
</tr>
<tr class="row-odd"><td><p>serviceId</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. An identifier for the corresponding service.</p></td>
</tr>
<tr class="row-even"><td><p>parameters</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">map&lt;string,</span> <span class="pre">parameter</span> <span class="pre">object&gt;</span></code> of <a class="reference internal" href="#parameter-object">Parameter object</a></p></td>
<td><p><strong>Required</strong>. A map of zero or more endpoint parameter names to
their parameter configuration.</p></td>
</tr>
<tr class="row-odd"><td><p>rules</p></td>
<td><p>An <code class="docutils literal notranslate"><span class="pre">array</span></code> of one or more of the following types: <a class="reference internal" href="#endpoint-rule-object">Endpoint rule
object</a>, <a class="reference internal" href="#error-rule-object">Error rule object</a>, or <a class="reference internal" href="#tree-rule-object">Tree rule object</a></p></td>
<td><p><strong>Required</strong>. One or more endpoint rule definitions of any rule type.</p></td>
</tr>
</tbody>
</table>
</div>
<p>A rule set defines endpoint parameters using the <code class="docutils literal notranslate"><span class="pre">parameters</span></code> property, and
maps zero or more parameter names to <a class="reference internal" href="#rules-engine-endpoint-rule-set-parameter"><span class="std std-ref">parameter object</span></a>
values.</p>
<p>Finally a rule set defines the <code class="docutils literal notranslate"><span class="pre">rules</span></code> property, which MUST contain one or
more of the following rule types: <a class="reference internal" href="#rules-engine-endpoint-rule-set-endpoint-rule"><span class="std std-ref">endpoint rules,</span></a>
<a class="reference internal" href="#rules-engine-endpoint-rule-set-error-rule"><span class="std std-ref">error rules,</span></a> or <a class="reference internal" href="#rules-engine-endpoint-rule-set-error-rule"><span class="std std-ref">tree rules.</span></a>
Rules are evaluated in order from their lowest array index position to highest.
If the list of rules is exhausted with none evaluated successfully, then an
implementation of the rule set engine MUST stop and return an error indicating
that rule exhaustion has occurred. Rule authors SHOULD use either an <a class="reference internal" href="#rules-engine-endpoint-rule-set-endpoint-rule"><span class="std std-ref">endpoint rule</span></a>
or <a class="reference internal" href="#rules-engine-endpoint-rule-set-error-rule"><span class="std std-ref">error rules,</span></a> with an
empty set of conditions to provide a more meaningful default or error depending
on the scenario.</p>
</section>
<section id="smithy-rules-endpointbdd-trait">
<span id="smithy-rules-endpointbdd-trait"></span><span id="id3"></span><h2><code class="docutils literal notranslate"><span class="pre">smithy.rules#endpointBdd</span></code> trait<a class="headerlink" href="#smithy-rules-endpointbdd-trait" title="Link to this heading">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Experimental</p>
<p>This trait is experimental and subject to change.</p>
</div>
<dl class="simple">
<dt>Summary</dt><dd><p>A <a class="reference external" href="https://en.wikipedia.org/wiki/Binary_decision_diagram">Binary Decision Diagram (BDD)</a> representation of
endpoint rules that is more compact and efficient at runtime than the decision-tree-based EndpointRuleSet trait.</p>
</dd>
<dt>Trait selector</dt><dd><p><code class="docutils literal notranslate"><span class="pre">service</span></code></p>
</dd>
<dt>Value type</dt><dd><p><code class="docutils literal notranslate"><span class="pre">structure</span></code></p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">endpointBdd</span></code> trait provides a BDD representation of endpoint rules, optimizing runtime evaluation by
eliminating redundant condition evaluations and reducing the decision tree to a minimal directed acyclic graph.
This trait is an alternative to <code class="docutils literal notranslate"><span class="pre">endpointRuleSet</span></code> that trades compile-time complexity for significantly improved
runtime performance and reduced artifact sizes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">endpointBdd</span></code> trait can be generated from an <code class="docutils literal notranslate"><span class="pre">endpointRuleSet</span></code> trait through compilation.
To generate the <code class="docutils literal notranslate"><span class="pre">endpointBdd</span></code> trait for a service, add the <a class="reference internal" href="../../guides/smithy-build-json.html#compilebdd-transform"><span class="std std-ref">compileBdd</span></a> transform
to the <code class="docutils literal notranslate"><span class="pre">smithy-build.json</span></code> file.
Services may provide either trait, with <code class="docutils literal notranslate"><span class="pre">endpointBdd</span></code> preferred for production use due to
its performance characteristics.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">endpointBdd</span></code> structure has the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 30.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>version</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. The endpoint rules engine version. Must be at least version 1.1.</p></td>
</tr>
<tr class="row-odd"><td><p>parameters</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">map&lt;string,</span> <span class="pre">parameter</span> <span class="pre">object&gt;</span></code> of <a class="reference internal" href="#parameter-object">Parameter object</a></p></td>
<td><p><strong>Required</strong>. A map of zero or more endpoint parameter names to
their parameter configuration. Uses the same parameter structure as
<code class="docutils literal notranslate"><span class="pre">endpointRuleSet</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>conditions</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">array</span></code> of <a class="reference internal" href="#condition-object">Condition object</a></p></td>
<td><p><strong>Required</strong>. Array of conditions that are evaluated during BDD
traversal. Each condition is referenced by its index in this array.</p></td>
</tr>
<tr class="row-odd"><td><p>results</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">array</span></code> of <a class="reference internal" href="#endpoint-rule-object">Endpoint rule object</a> or <a class="reference internal" href="#error-rule-object">Error rule object</a></p></td>
<td><p><strong>Required</strong>. Array of possible endpoint results. The implicit <cite>NoMatchRule</cite> at BDD reference 0 is not included
in the array. These rule objects MUST NOT contain conditions.</p></td>
</tr>
<tr class="row-even"><td><p>root</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">integer</span></code></p></td>
<td><p><strong>Required</strong>. The root reference where BDD evaluation begins.</p></td>
</tr>
<tr class="row-odd"><td><p>nodeCount</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">integer</span></code></p></td>
<td><p><strong>Required</strong>. The total number of nodes in the BDD. Used for validation and exact-sizing arrays during
deserialization.</p></td>
</tr>
<tr class="row-even"><td><p>nodes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. Base64-encoded binary representation of BDD nodes. Each node is encoded as three 4-byte
integers: <code class="docutils literal notranslate"><span class="pre">[conditionIndex,</span> <span class="pre">highRef,</span> <span class="pre">lowRef]</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<section id="bdd-node-structure">
<span id="rules-engine-endpoint-bdd-node-structure"></span><h3>BDD node structure<a class="headerlink" href="#bdd-node-structure" title="Link to this heading">¶</a></h3>
<p>Each BDD node is encoded as a triple of integers:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">conditionIndex</span></code>: Zero-based index into the <code class="docutils literal notranslate"><span class="pre">conditions</span></code> array</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">highRef</span></code>: Reference to follow when the condition evaluates to true</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lowRef</span></code>: Reference to follow when the condition evaluates to false</p></li>
</ul>
<p>The first node, index 0, is always the terminal node <code class="docutils literal notranslate"><span class="pre">[-1,</span> <span class="pre">1,</span> <span class="pre">-1]</span></code> and MUST NOT be referenced directly. This node
serves as the canonical base case for BDD reduction algorithms.</p>
</section>
<section id="reference-encoding">
<span id="rules-engine-endpoint-bdd-reference-encoding"></span><h3>Reference encoding<a class="headerlink" href="#reference-encoding" title="Link to this heading">¶</a></h3>
<p>BDD references use the following encoding scheme:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Reference value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p></td>
<td><p>Invalid/unused reference (never appears in valid BDDs)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p></td>
<td><p>TRUE terminal (no match in endpoint resolution)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-1</span></code></p></td>
<td><p>FALSE terminal (no match in endpoint resolution)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">...</span></code></p></td>
<td><p>Node references (points to <code class="docutils literal notranslate"><span class="pre">nodes[ref-1]</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-2,</span> <span class="pre">-3,</span> <span class="pre">-4,</span> <span class="pre">...</span></code></p></td>
<td><p>Complement edges (logical NOT of the referenced node)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">100000000+</span></code></p></td>
<td><p>Result terminals (100000000 + resultIndex)</p></td>
</tr>
</tbody>
</table>
</div>
<p>When traversing a complement edge (negative reference), the high and low branches are swapped during evaluation.
This enables significant node sharing and BDD size reduction.</p>
</section>
<section id="binary-node-encoding">
<span id="rules-engine-endpoint-bdd-binary-encoding"></span><h3>Binary node encoding<a class="headerlink" href="#binary-node-encoding" title="Link to this heading">¶</a></h3>
<p>Nodes are encoded as a Base64 string using binary encoding for efficiency:</p>
<ul class="simple">
<li><p>Each node consists of three 4-byte big-endian integers</p></li>
<li><p>Nodes are concatenated sequentially: <code class="docutils literal notranslate"><span class="pre">[node0,</span> <span class="pre">node1,</span> <span class="pre">...,</span> <span class="pre">nodeN-1]</span></code></p></li>
<li><p>The resulting byte array is Base64-encoded</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Why binary?</p>
<p>This encoding provides:</p>
<ul class="simple">
<li><p><strong>Size efficiency</strong>: smaller than an array of JSON integers, or an array of arrays of integers</p></li>
<li><p><strong>Performance</strong>: Direct deserialization into the target data structure (e.g., primitive arrays and integers)</p></li>
<li><p><strong>Cleaner diffs</strong>: BDD node changes appear as single-line modifications rather than spread over thousands
of numbers.</p></li>
</ul>
</div>
</section>
<section id="bdd-evaluation">
<span id="rules-engine-endpoint-bdd-evaluation"></span><h3>BDD evaluation<a class="headerlink" href="#bdd-evaluation" title="Link to this heading">¶</a></h3>
<p>BDD evaluation follows these steps:</p>
<ol class="arabic simple">
<li><p>Start at the root reference</p></li>
<li><p>While the reference is a node reference (not a terminal or result):</p>
<ul class="simple">
<li><p>Extract the node index: <code class="docutils literal notranslate"><span class="pre">nodeIndex</span> <span class="pre">=</span> <span class="pre">|ref|</span> <span class="pre">-</span> <span class="pre">1</span></code></p></li>
<li><p>Retrieve the node at that index</p></li>
<li><p>Evaluate the condition at <code class="docutils literal notranslate"><span class="pre">conditionIndex</span></code></p></li>
<li><p>Determine which branch to follow:</p>
<ul>
<li><p>If the reference is complemented (negative) AND condition is true: follow <code class="docutils literal notranslate"><span class="pre">lowRef</span></code></p></li>
<li><p>If the reference is complemented (negative) AND condition is false: follow <code class="docutils literal notranslate"><span class="pre">highRef</span></code></p></li>
<li><p>If the reference is positive AND condition is true: follow <code class="docutils literal notranslate"><span class="pre">highRef</span></code></p></li>
<li><p>If the reference is positive AND condition is false: follow <code class="docutils literal notranslate"><span class="pre">lowRef</span></code></p></li>
</ul>
</li>
<li><p>Update the reference to the chosen branch and continue</p></li>
</ul>
</li>
<li><p>When reaching a terminal or result:</p>
<ul class="simple">
<li><p>For result references ≥ 100000000: return <code class="docutils literal notranslate"><span class="pre">results[ref</span> <span class="pre">-</span> <span class="pre">100000000]</span></code></p></li>
<li><p>For terminals (1 or -1): return the <code class="docutils literal notranslate"><span class="pre">NoMatchRule</span></code></p></li>
</ul>
</li>
</ol>
<p>For example, a reference of 100000003 would return <code class="docutils literal notranslate"><span class="pre">results[3]</span></code>, while a reference of 1 or -1 indicates no matching
rule was found.</p>
</section>
<section id="validation-requirements">
<span id="rules-engine-endpoint-bdd-validation"></span><h3>Validation requirements<a class="headerlink" href="#validation-requirements" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>Root reference</strong>: MUST NOT be complemented (negative)</p></li>
<li><p><strong>Reference validity</strong>: All references MUST be valid:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> is forbidden</p></li>
<li><p>Node references MUST point to existing nodes</p></li>
<li><p>Result references MUST point to existing results</p></li>
</ul>
</li>
<li><p><strong>Node structure</strong>: Each node MUST be a properly formed triple</p></li>
<li><p><strong>Condition indices</strong>: Each node's condition index MUST be within <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">conditionCount)</span></code></p></li>
<li><p><strong>Result structure</strong>: The first result (index 0) implicitly represents <code class="docutils literal notranslate"><span class="pre">NoMatchRule</span></code> and is not serialized.
All serialized results MUST be either <code class="docutils literal notranslate"><span class="pre">EndpointRule</span></code> or <code class="docutils literal notranslate"><span class="pre">ErrorRule</span></code> objects without conditions.</p></li>
<li><p><strong>Version requirement</strong>: The version MUST be at least 1.1</p></li>
</ul>
</section>
</section>
<section id="parameter-object">
<span id="rules-engine-endpoint-rule-set-parameter"></span><h2>Parameter object<a class="headerlink" href="#parameter-object" title="Link to this heading">¶</a></h2>
<p>A parameter object contains the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 30.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. MUST be one of <code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">boolean</span></code>, or <code class="docutils literal notranslate"><span class="pre">stringArray</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>builtIn</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p>Specifies a named built-in value that is sourced and provided to the
endpoint provider by a caller.</p></td>
</tr>
<tr class="row-even"><td><p>default</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">boolean</span></code> or an array of <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p></td>
<td><p>Specifies the default value for the parameter if not set. Parameters
with defaults MUST also be marked as <code class="docutils literal notranslate"><span class="pre">required</span></code>. The type of the
provided default MUST match <code class="docutils literal notranslate"><span class="pre">type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>required</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td><p>Specifies that the parameter is required to be provided to the endpoint
provider.</p></td>
</tr>
<tr class="row-even"><td><p>documentation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. Specifies a string that SHOULD be used to generate API
reference documentation for the endpoint parameter.</p></td>
</tr>
<tr class="row-odd"><td><p>deprecated</p></td>
<td><p><a class="reference internal" href="#deprecated-object">Deprecated object</a></p></td>
<td><p>Specifies whether an endpoint parameter has been deprecated.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The parameter typing is statically analyzed by the rules engine to validate
correct usage within the rule set. <a class="reference internal" href="parameters.html#rules-engine-parameters-traits"><span class="std std-ref">Rules engine parameter traits</span></a>
allow values to be bound to parameters from other locations in generated
clients.</p>
<p>Parameters MAY be annotated with the <code class="docutils literal notranslate"><span class="pre">builtIn</span></code> property, which designates that
the parameter should be bound to a value determined by the built-in's name. The
<a class="reference internal" href="parameters.html#rules-engine-parameters-built-ins"><span class="std std-ref">rules engine contains built-ins</span></a> and
the set is extensible.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">required</span></code> property is used to validate that a parameter value MUST be set
prior to evaluating the rule set's rules. If a <code class="docutils literal notranslate"><span class="pre">required</span></code> parameter is not set,
rule evaluation MUST NOT proceed, and an implementation MUST return an error to
the user.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">default</span></code> property is used to set a default value on a property if a value
is not present. A parameter with the <code class="docutils literal notranslate"><span class="pre">default</span></code> property, MUST also be marked with
the <code class="docutils literal notranslate"><span class="pre">required</span></code> trait.</p>
<p>The following is an example of a parameter that is marked required.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;linkId&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;documentation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;The identifier of the link to target.&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;required&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Why must <code class="docutils literal notranslate"><span class="pre">required</span></code> be set when <code class="docutils literal notranslate"><span class="pre">default</span></code> is present?</p>
<p>The <code class="docutils literal notranslate"><span class="pre">required</span></code> property exists as sole the determiner for rules code
generation of &quot;is the parameter always going to be set?&quot; The <code class="docutils literal notranslate"><span class="pre">default</span></code>
property exists as a signal of where we can get the value from if
it's missing. By forcing both to be set, code generators can simplify their
handling of <code class="docutils literal notranslate"><span class="pre">required</span></code>.</p>
</div>
</section>
<section id="deprecated-object">
<span id="rules-engine-endpoint-rule-set-parameter-deprecated"></span><h2>Deprecated object<a class="headerlink" href="#deprecated-object" title="Link to this heading">¶</a></h2>
<p>A deprecated object contains the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 30.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>message</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p>Specifies an optional message that can be used in documentation to
provide recourse options to a user.</p></td>
</tr>
<tr class="row-odd"><td><p>since</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p>A date string that indicates when the parameter field was deprecated.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The following is an example of a parameter that is marked as deprecated.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;parameters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;linkId&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;string&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;deprecated&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;This feature has been deprecated, and requests are now directed towards a global endpoint.&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="nt">&quot;since&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-07-02&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="endpoint-rule-object">
<span id="rules-engine-endpoint-rule-set-endpoint-rule"></span><h2>Endpoint rule object<a class="headerlink" href="#endpoint-rule-object" title="Link to this heading">¶</a></h2>
<p>An endpoint rule object contains the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 30.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. MUST be <code class="docutils literal notranslate"><span class="pre">endpoint</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>conditions</p></td>
<td><p>An <code class="docutils literal notranslate"><span class="pre">array</span></code> of <a class="reference internal" href="#condition-object">Condition object</a></p></td>
<td><p><strong>Required</strong>. Zero or more conditions used to determine whether the
endpoint rule should be selected.</p></td>
</tr>
<tr class="row-even"><td><p>endpoint</p></td>
<td><p><a class="reference internal" href="#endpoint-object">Endpoint object</a></p></td>
<td><p><strong>Required</strong>. The endpoint to return if this rule is selected.</p></td>
</tr>
<tr class="row-odd"><td><p>documentation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p>A description of the rule.</p></td>
</tr>
</tbody>
</table>
</div>
<p>An endpoint rule MUST contain zero or more <code class="docutils literal notranslate"><span class="pre">conditions</span></code>. If all
<a class="reference internal" href="#rules-engine-endpoint-rule-set-condition"><span class="std std-ref">condition</span></a> clauses evaluate
successfully, the endpoint rule is selected. If a condition fails, evaluation
of the rule MUST be terminated and evaluation proceeds to any subsequent rules.</p>
<p>The following example defines an endpoint rule object that checks a condition
and uses a parameter value in a url template:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;documentation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;An endpoint rule description&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;endpoint&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;fn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;isValidHostLabel&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;argv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;linkId&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;endpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://{linkId}.service.com&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="endpoint-object">
<span id="rules-engine-endpoint-rule-set-endpoint"></span><h2>Endpoint object<a class="headerlink" href="#endpoint-object" title="Link to this heading">¶</a></h2>
<p>An endpoint object contains the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 30.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>url</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code> or <a class="reference internal" href="#reference-object">Reference object</a> or <a class="reference internal" href="#function-object">Function object</a></p></td>
<td><p><strong>Required</strong>. The endpoint url. This MUST specify a scheme and hostname
and MAY contain port and base path components. A <code class="docutils literal notranslate"><span class="pre">string</span></code> value MAY
be a <a class="reference internal" href="#template-string">Template string</a>. Any value for this property MUST resolve to a
<code class="docutils literal notranslate"><span class="pre">string</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>properties</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">map&lt;string,</span> <span class="pre">object&gt;</span></code></p></td>
<td><p>A map containing zero or more key value property pairs. Endpoint
properties MAY be arbitrarily deep and contain other maps and arrays.</p></td>
</tr>
<tr class="row-even"><td><p>headers</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">map&lt;string,</span> <span class="pre">array&gt;</span></code> where the <code class="docutils literal notranslate"><span class="pre">array</span></code> value is one or more of
following types: <code class="docutils literal notranslate"><span class="pre">string</span></code> or <a class="reference internal" href="#reference-object">Reference object</a> or <a class="reference internal" href="#function-object">Function
object</a></p></td>
<td><p>A map of transport header names to their respective values. A <code class="docutils literal notranslate"><span class="pre">string</span></code>
value in an array MAY be a template string.</p></td>
</tr>
</tbody>
</table>
</div>
<p>An <a class="reference internal" href="#rules-engine-endpoint-rule-set-endpoint-rule"><span class="std std-ref">endpoint rule</span></a> uses an
endpoint object to define an endpoint selected based on successful evaluation
of rule conditions to that point.</p>
<p>An endpoint MAY return a set of endpoint properties using the <code class="docutils literal notranslate"><span class="pre">properties</span></code>
field. This can be used to provide a grab-bag set of metadata associated with
an endpoint that an endpoint resolver implementation MAY use. For example, the
<code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> property is used to specify the priority ordered list of
authentication schemes and their configuration supported by the endpoint.
Properties MAY contain arbitrary nested maps and arrays of strings and
booleans.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To prevent ambiguity, the endpoint properties map MUST NOT contain
reference or function objects. Properties MAY contain <a class="reference internal" href="#rules-engine-endpoint-rule-set-template-string"><span class="std std-ref">template
string</span></a></p>
</div>
<section id="endpoint-authschemes-list-property">
<span id="rules-engine-endpoint-rule-set-endpoint-authschemes"></span><h3>Endpoint <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> list property<a class="headerlink" href="#endpoint-authschemes-list-property" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> property of an endpoint is used to specify a list of
authentication schemes and their configuration. These are used to modify
properties of the resolved and modeled authentication scheme. Clients SHOULD
resolve the authentication scheme following the service's <a class="reference internal" href="../../spec/authentication-traits.html#auth-trait"><span class="std std-ref">auth trait</span></a> and SHOULD NOT use the endpoint's <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> property to
determine which authentication scheme to use. Clients SHOULD use the
endpoint's <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> property to modify signing properties of the
resolved authentication scheme.</p>
<p>The property is a list of configuration objects that MUST contain at least a
<code class="docutils literal notranslate"><span class="pre">name</span></code> property and MAY contain additional properties. Each configuration
object MUST have a unique value for its <code class="docutils literal notranslate"><span class="pre">name</span></code> property within the list of
configuration objects within a given <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> property.</p>
<p>If an <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> property is present on an <a class="reference internal" href="#endpoint-object">Endpoint object</a>, clients
SHOULD modify the signing properties of the resolved and modeled authentication
scheme via the following process:</p>
<ol class="arabic simple">
<li><p>Iterate through configuration objects in the <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> property.</p></li>
<li><p>If the <code class="docutils literal notranslate"><span class="pre">name</span></code> property in a configuration object matches the resolved
authentication scheme, update the resolved authentication and signing
properties from the matching <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> properties.</p></li>
<li><p>If the <code class="docutils literal notranslate"><span class="pre">name</span></code> does not match, ignore it and continue iterating.</p></li>
<li><p>If the list has been fully iterated and no scheme has matched, do not
modify the resolved authentication scheme's properties
and do not raise an error.</p></li>
</ol>
<section id="adding-authschemes-configuration-validators">
<span id="rules-engine-standard-library-adding-authscheme-validators"></span><h4>Adding <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> configuration validators<a class="headerlink" href="#adding-authschemes-configuration-validators" title="Link to this heading">¶</a></h4>
<p>Extensions to the rules engine can provide additional validators for
<code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> configuration objects. No validators are provided by default.</p>
<p>The rules engine is highly extensible through
<code class="docutils literal notranslate"><span class="pre">software.amazon.smithy.rulesengine.language.EndpointRuleSetExtension</span></code>
<a class="reference external" href="https://docs.oracle.com/javase/tutorial/sound/SPI-intro.html">service providers</a>. See the <a class="reference external" href="https://smithy.io/javadoc/1.68.0/software/amazon/smithy/rulesengine/language/EndpointRuleSetExtension.html">Javadocs</a> for more information.</p>
</section>
</section>
</section>
<section id="error-rule-object">
<span id="rules-engine-endpoint-rule-set-error-rule"></span><h2>Error rule object<a class="headerlink" href="#error-rule-object" title="Link to this heading">¶</a></h2>
<p>An error rule object contains the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 30.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. MUST be <code class="docutils literal notranslate"><span class="pre">error</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>conditions</p></td>
<td><p>An <code class="docutils literal notranslate"><span class="pre">array</span></code> of <a class="reference internal" href="#condition-object">Condition object</a></p></td>
<td><p><strong>Required</strong>. Zero or more conditions used to determine whether the
endpoint rule should be selected.</p></td>
</tr>
<tr class="row-even"><td><p>error</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code> or <a class="reference internal" href="#reference-object">Reference object</a> or <a class="reference internal" href="#function-object">Function object</a></p></td>
<td><p><strong>Required</strong>. A descriptive message describing the error for consumption
by the caller. A <code class="docutils literal notranslate"><span class="pre">string</span></code> value MAY be a <a class="reference internal" href="#template-string">Template string</a>. Any
value for this property MUST resolve to a <code class="docutils literal notranslate"><span class="pre">string</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>documentation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p>A description of the rule.</p></td>
</tr>
</tbody>
</table>
</div>
<p>An error rule MUST contain zero or more <code class="docutils literal notranslate"><span class="pre">conditions</span></code>. If all
<a class="reference internal" href="#rules-engine-endpoint-rule-set-condition"><span class="std std-ref">condition</span></a> clauses evaluate
successfully or zero conditions are defined, then the error rule MUST be
selected. If a condition fails evaluation, the rule MUST be terminated and
evaluation proceeds to any subsequent rules.</p>
<p>The following example defines an error rule object that checks a condition:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;documentation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;An error rule description.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;fn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;not&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;argv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;fn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;isValidHostLabel&quot;</span><span class="p">,</span>
<span class="w">                    </span><span class="nt">&quot;argv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                        </span><span class="p">{</span>
<span class="w">                            </span><span class="nt">&quot;ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;linkId&quot;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">]</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{linkId} must be a valid HTTP host label.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In production rule sets, rather than using <code class="docutils literal notranslate"><span class="pre">not</span></code>, it's more common to see
rules where the error rule has no conditions and is only matched after all
other rules have failed to match.</p>
</div>
</section>
<section id="tree-rule-object">
<span id="rules-engine-endpoint-rule-set-tree-rule"></span><h2>Tree rule object<a class="headerlink" href="#tree-rule-object" title="Link to this heading">¶</a></h2>
<p>A tree rule object contains the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 30.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property name</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>type</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. MUST be <code class="docutils literal notranslate"><span class="pre">tree</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>conditions</p></td>
<td><p>An <code class="docutils literal notranslate"><span class="pre">array</span></code> of <a class="reference internal" href="#condition-object">Condition object</a></p></td>
<td><p><strong>Required</strong>. Zero or more conditions used to determine whether the
endpoint rule should be selected.</p></td>
</tr>
<tr class="row-even"><td><p>rules</p></td>
<td><p>An <code class="docutils literal notranslate"><span class="pre">array</span></code> of one or more of the following types: <a class="reference internal" href="#endpoint-rule-object">Endpoint rule
object</a>, <a class="reference internal" href="#error-rule-object">Error rule object</a>, or <a class="reference internal" href="#tree-rule-object">Tree rule object</a></p></td>
<td><p><strong>Required</strong>. One or more endpoint rule definitions of any rule type.</p></td>
</tr>
<tr class="row-odd"><td><p>documentation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p>A description of the rule.</p></td>
</tr>
</tbody>
</table>
</div>
<p>A tree rule MUST contain one or more <code class="docutils literal notranslate"><span class="pre">conditions</span></code>. If all
<a class="reference internal" href="#rules-engine-endpoint-rule-set-condition"><span class="std std-ref">condition</span></a> clauses evaluate
successfully, the tree rule is selected. If a condition fails, evaluation of
the rule MUST be terminated and evaluation proceeds to any subsequent rules.</p>
<p>A tree rule MUST have one or more subordinate rules specified using the <code class="docutils literal notranslate"><span class="pre">rules</span></code>
property. A tree rule is equivalent to the following logical expression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">treeCondition1</span> <span class="o">&amp;&amp;</span> <span class="o">...</span> <span class="o">&amp;&amp;</span> <span class="n">treeConditionN</span> <span class="o">&amp;&amp;</span> <span class="p">(</span> <span class="n">subRule1</span> <span class="o">||</span> <span class="o">...</span> <span class="o">||</span> <span class="n">subRuleN</span> <span class="p">)</span>
</pre></div>
</div>
<p>Tree rules are considered terminal branches of the rule set. If a tree rule’s
subordinate rules are exhausted with none evaluated successfully, then an
implementation of the rules engine MUST stop and return an error indicating
that rule exhaustion has occurred.</p>
<p>Rule authors SHOULD use either an <a class="reference internal" href="#endpoint-rule-object">Endpoint rule object</a> or <a class="reference internal" href="#error-rule-object">Error rule object</a>
with an empty set of conditions to provide a more meaningful default or error,
depending on the scenario.</p>
<p>The following example is an abbreviated example of a tree rule that consists
of a tree, endpoint, and error rule.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;fn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;isValidHostLabel&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;argv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;linkId&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tree&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;rules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tree&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="c1">// Abbreviated for clarity</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;rules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="c1">// Abbreviated for clarity</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;endpoint&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="c1">// Abbreviated for clarity</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;endpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;{linkId}.service.com&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;error&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="c1">// Abbreviated for clarity</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;error&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;An error message.&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="condition-object">
<span id="rules-engine-endpoint-rule-set-condition"></span><h2>Condition object<a class="headerlink" href="#condition-object" title="Link to this heading">¶</a></h2>
<p>A condition is specified using an object containing the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 50.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>fn</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. The name of the function to be executed.</p></td>
</tr>
<tr class="row-odd"><td><p>argv</p></td>
<td><p>An <code class="docutils literal notranslate"><span class="pre">array</span></code> of one or more of the following types: <code class="docutils literal notranslate"><span class="pre">string</span></code>,
<code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">array</span></code>, <a class="reference internal" href="#reference-object">Reference object</a>, or <a class="reference internal" href="#function-object">Function object</a></p></td>
<td><p><strong>Required</strong>. The arguments for the function.</p></td>
</tr>
<tr class="row-even"><td><p>assign</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p>The destination variable to assign the functions result to.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Conditions are defined within rule objects as requirements for continuing to
evaluate the rules within. Conditions are evaluated in-order by their
positional index in the array, starting from zero. Conditions represent the
logical expression <code class="docutils literal notranslate"><span class="pre">condition1</span> <span class="pre">&amp;&amp;</span> <span class="pre">...</span> <span class="pre">&amp;&amp;</span> <span class="pre">conditionN</span></code> where <code class="docutils literal notranslate"><span class="pre">condition1</span></code>
through <code class="docutils literal notranslate"><span class="pre">conditionN</span></code> are each condition objects.</p>
<p>If a condition returns <code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>, the condition does not match. A
condition that does not match MUST immediately terminate the evaluation of the
rule. Processing starts at the next immediate rule to be evaluated. In order
for a rule's right-hand-side to be considered, all conditions MUST match.
Conditions MAY use references defined in previous conditions in the same rule.</p>
<p>A condition object MAY assign the output result of a function to a named
variable using the <code class="docutils literal notranslate"><span class="pre">assign</span></code> property. Variables created using <code class="docutils literal notranslate"><span class="pre">assign</span></code>
follow the same rules as parameter name identifiers. Variables are scoped to
the rule they are defined in, with variables created in a tree rule being
visible to all subordinate rules and their children. For <a class="reference internal" href="#rules-engine-endpoint-rule-set-endpoint-rule"><span class="std std-ref">endpoint rules</span></a>
or <a class="reference internal" href="#rules-engine-endpoint-rule-set-error-rule"><span class="std std-ref">error rules</span></a>, the variable
will fall out of scope once evaluation of the rule has completed. A condition
may also reference a variable declared by a prior condition statement within
the same rule. Assigned variables are similar to <a class="reference internal" href="#rules-engine-endpoint-rule-set-parameter"><span class="std std-ref">parameters</span></a>
and can be referenced in string templates or passed as values to other
functions. Variable names MUST NOT overlap with existing parameter names or
variable declarations in scope.</p>
<p>The following example shows using the <a class="reference internal" href="standard-library.html#rules-engine-standard-library-stringequals"><span class="std std-ref">stringEquals function</span></a>
to compare two arguments as a prerequisite to an endpoint object:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;endpoint&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;documentation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Use the base endpoint if using the default link&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;fn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stringEquals&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;argv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;linkId&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="s2">&quot;default&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;endpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://service.com&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following example shows the invocation of the <a class="reference internal" href="standard-library.html#rules-engine-standard-library-parseurl"><span class="std std-ref">parseUrl</span></a>
function, taking a single argument and assigning the result to the <code class="docutils literal notranslate"><span class="pre">url</span></code>
variable. The <code class="docutils literal notranslate"><span class="pre">url</span></code> variable is then used as part of a template string in an
endpoint object.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;endpoint&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;conditions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;fn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;parseURL&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;argv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Endpoint&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;assign&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;url&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;endpoint&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://service.com/{url#path}&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="function-object">
<span id="rules-engine-endpoint-rule-set-function"></span><h2>Function object<a class="headerlink" href="#function-object" title="Link to this heading">¶</a></h2>
<p>A function is specified using an object containing the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 50.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>fn</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. The name of the function to be executed.</p></td>
</tr>
<tr class="row-odd"><td><p>argv</p></td>
<td><p>An <code class="docutils literal notranslate"><span class="pre">array</span></code> of one or more of the following types: <code class="docutils literal notranslate"><span class="pre">string</span></code>,
<code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">array</span></code>, <a class="reference internal" href="#reference-object">Reference object</a>, or <a class="reference internal" href="#function-object">Function object</a></p></td>
<td><p><strong>Required</strong>. The arguments for the function.</p></td>
</tr>
</tbody>
</table>
</div>
<p>All functions have specific type signatures associated with their definition.
Static analysis validates that all arguments passed to a function are of the
correct type.</p>
<p>The <a class="reference internal" href="standard-library.html#rules-engine-standard-library"><span class="std std-ref">rules engine contains functions</span></a> and
the set is extensible.</p>
</section>
<section id="reference-object">
<span id="rules-engine-endpoint-rule-set-reference"></span><h2>Reference object<a class="headerlink" href="#reference-object" title="Link to this heading">¶</a></h2>
<p>A reference is an object containing the following properties:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 50.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ref</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><strong>Required</strong>. The name of the parameter or variable.</p></td>
</tr>
</tbody>
</table>
</div>
<p>References allow for parameter and variable assignments, created by a condition
object, to be used in subsequent rules and conditions. A parameter MUST be
checked with an <code class="docutils literal notranslate"><span class="pre">isSet</span></code> condition object to determine whether the parameter
is set and can be safely used. The rules engine statically verifies references
are valid at time-of-use.</p>
</section>
<section id="template-string">
<span id="rules-engine-endpoint-rule-set-template-string"></span><h2>Template string<a class="headerlink" href="#template-string" title="Link to this heading">¶</a></h2>
<p>String values in rules can use the <code class="docutils literal notranslate"><span class="pre">{parameterName}</span></code> syntax for defining
automatic templating of the named parameter or variable values into a string.
For example, if the string <code class="docutils literal notranslate"><span class="pre">{parameterName}.foobar.baz</span></code> is defined in the
rule set and <code class="docutils literal notranslate"><span class="pre">parameterName</span></code> is bound to the value <code class="docutils literal notranslate"><span class="pre">foo</span></code>, the resolved
string value would be <code class="docutils literal notranslate"><span class="pre">foo.foobar.baz</span></code>.</p>
<p>Template string parameters follow the same de-referencing rules as outlined
in reference object. The rules engine statically verifies referenced
parameters in template strings.</p>
<section id="template-shorthand">
<span id="rules-engine-endpoint-rule-set-template-string-shorthand"></span><h3>Template shorthand<a class="headerlink" href="#template-shorthand" title="Link to this heading">¶</a></h3>
<p>Template parameters also support a shorthand syntax for accessing nested
properties or array arguments using the <code class="docutils literal notranslate"><span class="pre">#</span></code> character. This syntax is
syntactic sugar for using the long-form <code class="docutils literal notranslate"><span class="pre">getAttr</span></code> function. For example,
<code class="docutils literal notranslate"><span class="pre">{parameterName#foo}</span></code>, with <code class="docutils literal notranslate"><span class="pre">parameterName</span></code> being a variable containing a
JSON object, and <code class="docutils literal notranslate"><span class="pre">foo</span></code> being a property defined on that object.</p>
<p>The following two expressions are equivalent:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;fn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stringEquals&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;argv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;linkId&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;fn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;getAttr&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;argv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                    </span><span class="nt">&quot;ref&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;partResult&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="p">[</span>
<span class="w">                    </span><span class="s2">&quot;name&quot;</span>
<span class="w">                </span><span class="p">]</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;fn&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;stringEquals&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;argv&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;linkId&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;{partResult#name}&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="parameters.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Rules engine parameters</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Rules engine</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Amazon Web Services
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/smithy-lang/smithy" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Rules engine specification</a><ul>
<li><a class="reference internal" href="#rules-engine-version">Rules engine version</a></li>
<li><a class="reference internal" href="#smithy-rules-endpointruleset-trait"><code class="docutils literal notranslate"><span class="pre">smithy.rules#endpointRuleSet</span></code> trait</a></li>
<li><a class="reference internal" href="#smithy-rules-endpointbdd-trait"><code class="docutils literal notranslate"><span class="pre">smithy.rules#endpointBdd</span></code> trait</a><ul>
<li><a class="reference internal" href="#bdd-node-structure">BDD node structure</a></li>
<li><a class="reference internal" href="#reference-encoding">Reference encoding</a></li>
<li><a class="reference internal" href="#binary-node-encoding">Binary node encoding</a></li>
<li><a class="reference internal" href="#bdd-evaluation">BDD evaluation</a></li>
<li><a class="reference internal" href="#validation-requirements">Validation requirements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameter-object">Parameter object</a></li>
<li><a class="reference internal" href="#deprecated-object">Deprecated object</a></li>
<li><a class="reference internal" href="#endpoint-rule-object">Endpoint rule object</a></li>
<li><a class="reference internal" href="#endpoint-object">Endpoint object</a><ul>
<li><a class="reference internal" href="#endpoint-authschemes-list-property">Endpoint <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> list property</a><ul>
<li><a class="reference internal" href="#adding-authschemes-configuration-validators">Adding <code class="docutils literal notranslate"><span class="pre">authSchemes</span></code> configuration validators</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#error-rule-object">Error rule object</a></li>
<li><a class="reference internal" href="#tree-rule-object">Tree rule object</a></li>
<li><a class="reference internal" href="#condition-object">Condition object</a></li>
<li><a class="reference internal" href="#function-object">Function object</a></li>
<li><a class="reference internal" href="#reference-object">Reference object</a></li>
<li><a class="reference internal" href="#template-string">Template string</a><ul>
<li><a class="reference internal" href="#template-shorthand">Template shorthand</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=60dbed4a"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=6b89569b"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    </body>
</html>