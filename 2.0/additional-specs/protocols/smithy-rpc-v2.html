<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html"><link rel="search" title="Search" href="../../search.html"><link rel="next" title="AWS integrations" href="../../aws/index.html"><link rel="prev" title="Protocols" href="index.html">
        <link rel="prefetch" href="../../_static/smithy.svg" as="image">
        <link rel="prefetch" href="../../_static/smithy-dark.svg" as="image">

    <link rel="shortcut icon" href="../../_static/favicon.svg"><!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>Smithy RPC v2 CBOR protocol - Smithy 2.0</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=0abfef4d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --admonition-font-size: 100%;
  --admonition-title-font-size: 100%;
  --color-brand-primary: #C44536;
  --color-brand-content: #00808b;
  --color-announcement-background: #f8f8f8;
  --color-announcement-text: #383838;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #282828;
  --color-code-foreground: #dddddd;
  --color-brand-primary: #ed9d13;
  --color-brand-content: #58d3ff;
  --color-announcement-background: ##1a1c1e;;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #282828;
  --color-code-foreground: #dddddd;
  --color-brand-primary: #ed9d13;
  --color-brand-content: #58d3ff;
  --color-announcement-background: ##1a1c1e;;
  
      }
    }
  }
</style><script src="https://a0.awsstatic.com/s_code/js/3.0/awshome_s_code.js"></script>
<script src="https://d2c.aws.amazon.com/client/loader/v1/d2c-load.js"></script></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Smithy 2.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="/index.html">
  
  <div class="sidebar-brand-icon">
    <img class="sidebar-logo only-light" src="../../_static/smithy.svg" alt="Logo">
    <img class="sidebar-logo only-dark" src="../../_static/smithy-dark.svg" alt="Logo">
  </div>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick start</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../spec/index.html">Smithy specification</a><input aria-label="Toggle navigation of Smithy specification" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../spec/model.html">1. The Smithy model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/simple-types.html">2. Simple types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/aggregate-types.html">3. Aggregate types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/service-types.html">4. Service types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/mixins.html">5. Mixins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/constraint-traits.html">6. Constraint traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/type-refinement-traits.html">7. Type refinement traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/documentation-traits.html">8. Documentation traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/behavior-traits.html">9. Behavior traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/resource-traits.html">10. Resource traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/authentication-traits.html">11. Authentication traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/protocol-traits.html">12. Serialization and Protocol traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/streaming.html">13. Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/http-bindings.html">14. HTTP bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/endpoint-traits.html">15. Endpoint traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/selectors.html">16. Selectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/model-validation.html">17. Model validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/idl.html">18. Smithy IDL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../spec/json-ast.html">19. JSON AST</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../trait-index.html">Trait index</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../guides/index.html">Guides</a><input aria-label="Toggle navigation of Guides" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/smithy-cli/index.html">The Smithy CLI</a><input aria-label="Toggle navigation of The Smithy CLI" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/smithy-cli/cli_installation.html">Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/smithy-build-json.html">smithy-build.json</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/gradle-plugin/index.html">Smithy Gradle Plugins</a><input aria-label="Toggle navigation of Smithy Gradle Plugins" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/gradle-plugin/gradle-migration-guide.html">Migrating to Gradle plugin version 0.10.0+</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/using-code-generation/index.html">Code Generation</a><input aria-label="Toggle navigation of Code Generation" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/using-code-generation/update-model.html">Updating the Smithy Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/using-code-generation/generating-a-client.html">Generating a client</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/model-linters.html">Linting Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/model-validation-examples.html">Model Validation Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/evolving-models.html">Evolving Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/wire-protocol-selection.html">Wire protocol selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/style-guide.html">Style Guide</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/model-translations/index.html">Model Translations</a><input aria-label="Toggle navigation of Model Translations" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/model-translations/converting-to-openapi.html">Converting Smithy to OpenAPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/model-translations/migrating-idl-1-to-2.html">Smithy IDL 1.0 to 2.0 Migration Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/model-translations/generating-cloudformation-resources.html">Generating CloudFormation Resource Schemas from Smithy</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/building-codegen/index.html">Creating a Code Generator</a><input aria-label="Toggle navigation of Creating a Code Generator" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/overview-and-concepts.html">Overview and Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/mapping-shapes-to-languages.html">Mapping Smithy Shapes to Your Language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/creating-codegen-repo.html">Creating a Codegen Repo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/configuring-the-generator.html">Configuring the Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/implementing-the-generator.html">Implementing the Generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/making-codegen-pluggable.html">Making Codegen Pluggable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/generating-code.html">Generating Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/decoupling-codegen-with-symbols.html">Decoupling Codegen with Symbols</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/building-codegen/using-the-semantic-model.html">Using the Semantic Model</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/client-guidance/index.html">Smithy Client Guidance</a><input aria-label="Toggle navigation of Smithy Client Guidance" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../guides/client-guidance/application-protocols/index.html">Application Protocols</a><input aria-label="Toggle navigation of Application Protocols" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../guides/client-guidance/application-protocols/http.html">HTTP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/client-guidance/context.html">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/client-guidance/retries.html">Retrying Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/client-guidance/endpoints.html">Endpoint Resolution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a><input aria-label="Toggle navigation of Tutorials" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/full-stack-tutorial.html">Full Stack Application</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Additional specs</a><input aria-label="Toggle navigation of Additional specs" checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ai-traits.html">Smithy AI Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contract-traits.html">Contract traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../http-protocol-compliance-tests.html">HTTP Protocol Compliance Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../event-stream-protocol-compliance-tests.html">Event Stream Protocol Compliance Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../smoke-tests.html">Smoke Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../waiters.html">Waiters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mqtt.html">MQTT Protocol Bindings</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../rules-engine/index.html">Rules engine</a><input aria-label="Toggle navigation of Rules engine" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../rules-engine/specification.html">Rules engine specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rules-engine/parameters.html">Rules engine parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rules-engine/standard-library.html">Rules engine standard library</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Protocols</a><input aria-label="Toggle navigation of Protocols" checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Smithy RPC v2 CBOR protocol</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../aws/index.html">AWS integrations</a><input aria-label="Toggle navigation of AWS integrations" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-core.html">AWS Core Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-auth.html">AWS Authentication Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-endpoints-region.html">AWS Declarative Endpoint Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-iam.html">AWS IAM traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/amazon-apigateway.html">Amazon API Gateway traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/aws-cloudformation.html">AWS CloudFormation Traits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../aws/amazon-eventstream.html">Amazon Event Stream Specification</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../aws/protocols/index.html">AWS Protocols</a><input aria-label="Toggle navigation of AWS Protocols" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-restjson1-protocol.html">AWS restJson1 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-json-1_0-protocol.html">AWS JSON 1.0 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-json-1_1-protocol.html">AWS JSON 1.1 protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-restxml-protocol.html">AWS restXml protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-query-protocol.html">AWS query protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/protocols/aws-ec2-query-protocol.html">AWS EC2 query protocol</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../aws/customizations/index.html">AWS Service Customizations</a><input aria-label="Toggle navigation of AWS Service Customizations" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../aws/customizations/apigateway-customizations.html">Amazon API Gateway Customizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/customizations/glacier-customizations.html">Amazon Glacier Customizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/customizations/machinelearning-customizations.html">Amazon Machine Learning Customizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/customizations/s3-customizations.html">Amazon S3 Customizations</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../aws/rules-engine/index.html">AWS rules engine extensions</a><input aria-label="Toggle navigation of AWS rules engine extensions" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../aws/rules-engine/built-ins.html">AWS rules engine built-ins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/rules-engine/library-functions.html">AWS rules engine library functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../aws/rules-engine/auth-schemes.html">AWS rules engine authentication scheme validators</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Languages</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/java/index.html">Java</a><input aria-label="Toggle navigation of Java" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../languages/java/quickstart.html">Java Quickstart</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../languages/java/client/index.html">Client User Guide</a><input aria-label="Toggle navigation of Client User Guide" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/generating-clients.html">Generating Clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/configuration.html">Configuring Clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/customization.html">Customizing Client Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/plugins.html">Client Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/dynamic-client.html">Dynamic Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/java/client/codegen-integrations.html">Codegen Integrations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-java">Source code</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-java/tree/0.0.3/examples">Smithy Java Examples</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/typescript/index.html">TypeScript</a><input aria-label="Toggle navigation of TypeScript" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../languages/typescript/quickstart.html">TypeScript Quickstart</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../languages/typescript/ts-ssdk/index.html">Server Generator for TypeScript</a><input aria-label="Toggle navigation of Server Generator for TypeScript" class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/introduction.html">Introduction to the Smithy Server Generator for TypeScript</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/handlers.html">Smithy Server Generator for TypeScript handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/validation.html">Smithy Server Generator for TypeScript validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/error-handling.html">Smithy Server Generator for TypeScript error handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../languages/typescript/ts-ssdk/supported-endpoints.html">Smithy Server Generator for TypeScript supported endpoints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-typescript">Source code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/full-stack-tutorial.html">Smithy Full Stack Application</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/rust/index.html">Rust</a><input aria-label="Toggle navigation of Rust" class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://smithy-lang.github.io/smithy-rs/design/">Design Documentation</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-rs">Source code</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/python/index.html">Python</a><input aria-label="Toggle navigation of Python" class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-python">Source code</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/kotlin/index.html">Kotlin</a><input aria-label="Toggle navigation of Kotlin" class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../languages/kotlin/quickstart.html">Kotlin Quickstart</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../languages/kotlin/client/index.html">Client User Guide</a><input aria-label="Toggle navigation of Client User Guide" class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../languages/kotlin/client/generating-clients.html">Generating Clients</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-kotlin">Source code</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-examples/tree/main/smithy-kotlin-examples">Smithy Kotlin Examples</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/smithy-lang/smithy-kotlin/tree/main/docs/design">Smithy Kotlin Design Docs</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/golang/index.html">GoLang</a><input aria-label="Toggle navigation of GoLang" class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://github.com/aws/smithy-go">Source code</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../languages/scala/index.html">Scala</a><input aria-label="Toggle navigation of Scala" class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference external" href="https://disneystreaming.github.io/smithy4s/">Documentation</a></li>
<li class="toctree-l2"><a class="reference external" href="https://github.com/disneystreaming/smithy4s">Source code</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/smithy-lang/smithy">Source code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/smithy-lang/awesome-smithy">Awesome Smithy</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/smithy-lang/smithy-examples">Smithy Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://smithy.io/1.0/">1.0 Documentation</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="https://github.com/smithy-lang/smithy/blob/main/docs/source-2.0/additional-specs/protocols/smithy-rpc-v2.rst?plain=true" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div><div class="edit-this-page">
  <a class="muted-link" href="https://github.com/smithy-lang/smithy/edit/main/docs/source-2.0/additional-specs/protocols/smithy-rpc-v2.rst" rel="edit" title="Edit this page">
    <svg><use href="#svg-pencil"></use></svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="smithy-rpc-v2-cbor-protocol">
<span id="smithy-rpc-v2-cbor"></span><h1>Smithy RPC v2 CBOR protocol<a class="headerlink" href="#smithy-rpc-v2-cbor-protocol" title="Link to this heading">¶</a></h1>
<p>This specification defines the <code class="docutils literal notranslate"><span class="pre">smithy.protocols#rpcv2Cbor</span></code> protocol. This
protocol is used to expose services that serialize RPC payloads as CBOR.</p>
<section id="smithy-protocols-rpcv2cbor-trait">
<span id="smithy-protocols-rpcv2cbor-trait"></span><span id="id1"></span><h2><code class="docutils literal notranslate"><span class="pre">smithy.protocols#rpcv2Cbor</span></code> trait<a class="headerlink" href="#smithy-protocols-rpcv2cbor-trait" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>Summary</dt><dd><p>Adds support for an RPC-based protocol over HTTP that sends requests and
responses with CBOR payloads.</p>
</dd>
<dt>Trait selector</dt><dd><p><code class="docutils literal notranslate"><span class="pre">service</span></code></p>
</dd>
<dt>Value type</dt><dd><p>Structure</p>
</dd>
<dt>See</dt><dd><p><a class="reference external" href="https://github.com/smithy-lang/smithy/tree/1.68.0/smithy-protocol-tests/model/rpcv2Cbor">Protocol tests</a></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">smithy.protocols#rpcv2Cbor</span></code> is a structure that supports the following
members:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 10.0%" />
<col style="width: 20.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>http</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[string]</span></code></p></td>
<td><p>The priority ordered list of supported HTTP protocol versions.</p></td>
</tr>
<tr class="row-odd"><td><p>eventStreamHttp</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[string]</span></code></p></td>
<td><p>The priority ordered list of supported HTTP protocol versions
that are required when using <a class="reference internal" href="../../spec/streaming.html#event-streams"><span class="std std-ref">event streams</span></a>
with the service. If not set, this value defaults to the value
of the <code class="docutils literal notranslate"><span class="pre">http</span></code> member. Any entry in <code class="docutils literal notranslate"><span class="pre">eventStreamHttp</span></code> MUST
also appear in <code class="docutils literal notranslate"><span class="pre">http</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Each entry in <code class="docutils literal notranslate"><span class="pre">http</span></code> and <code class="docutils literal notranslate"><span class="pre">eventStreamHttp</span></code> SHOULD be a valid
<a class="reference external" href="https://www.iana.org/assignments/tls-extensiontype-values/tls-extensiontype-values.xhtml#alpn-protocol-ids">Application-Layer Protocol Negotiation (ALPN) Protocol ID</a> (for example,
<code class="docutils literal notranslate"><span class="pre">http/1.1</span></code>, <code class="docutils literal notranslate"><span class="pre">h2</span></code>, etc). Clients SHOULD pick the first protocol in the
list they understand when connecting to a service. A client SHOULD assume
that a service supports <code class="docutils literal notranslate"><span class="pre">http/1.1</span></code> when no <code class="docutils literal notranslate"><span class="pre">http</span></code> or <code class="docutils literal notranslate"><span class="pre">eventStreamHttp</span></code>
values are provided.</p>
<p>Event streaming uses the <a class="reference internal" href="../../aws/amazon-eventstream.html#amazon-eventstream"><span class="std std-ref">Amazon Event Stream Specification</span></a> format.</p>
<p>The following example defines a service that uses
<code class="docutils literal notranslate"><span class="pre">smithy.protocols#rpcv2Cbor</span></code>.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>

<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">use </span><span class="nc">smithy.protocols#rpcv2Cbor</span>

<span class="nt">@rpcv2Cbor</span>
<span class="kd">service </span><span class="nc">MyService</span><span class="w"> </span>{
<span class="w">    </span><span class="py">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-07-02&quot;</span>
}
</pre></div>
</div>
<p>The following example defines a service that requires the use of
<code class="docutils literal notranslate"><span class="pre">h2</span></code> when using event streams.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>

<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">use </span><span class="nc">smithy.protocols#rpcv2Cbor</span>

<span class="nt">@rpcv2Cbor</span>(
<span class="w">    </span><span class="py">http</span><span class="p">:</span><span class="w"> </span>[<span class="s2">&quot;h2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;http/1.1&quot;</span>]<span class="p">,</span>
<span class="w">    </span><span class="py">eventStreamHttp</span><span class="p">:</span><span class="w"> </span>[<span class="s2">&quot;h2&quot;</span>]
)
<span class="kd">service </span><span class="nc">MyService</span><span class="w"> </span>{
<span class="w">    </span><span class="py">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-02-05&quot;</span>
}
</pre></div>
</div>
<p>The following example defines a service that requires the use of
<code class="docutils literal notranslate"><span class="pre">h2</span></code> or <code class="docutils literal notranslate"><span class="pre">http/1.1</span></code> when using event streams, where <code class="docutils literal notranslate"><span class="pre">h2</span></code> is
preferred over <code class="docutils literal notranslate"><span class="pre">http/1.1</span></code>.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>

<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">use </span><span class="nc">smithy.protocols#rpcv2Cbor</span>

<span class="nt">@rpcv2Cbor</span>(
<span class="w">    </span><span class="py">http</span><span class="p">:</span><span class="w"> </span>[<span class="s2">&quot;h2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;http/1.1&quot;</span>]<span class="p">,</span>
<span class="w">    </span><span class="py">eventStreamHttp</span><span class="p">:</span><span class="w"> </span>[<span class="s2">&quot;h2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;http/1.1&quot;</span>]
)
<span class="kd">service </span><span class="nc">MyService</span><span class="w"> </span>{
<span class="w">    </span><span class="py">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-02-05&quot;</span>
}
</pre></div>
</div>
<p>The following example defines a service that requires the use of
<code class="docutils literal notranslate"><span class="pre">h2</span></code> for all requests, including event streams.</p>
<div class="highlight-smithy notranslate"><div class="highlight"><pre><span></span><span class="kd">$version</span><span class="nd">:</span><span class="w"> </span><span class="s2">&quot;2&quot;</span>

<span class="kd">namespace </span><span class="nc">smithy.example</span>

<span class="kd">use </span><span class="nc">smithy.protocols#rpcv2Cbor</span>

<span class="nt">@rpcv2Cbor</span>(<span class="py">http</span><span class="p">:</span><span class="w"> </span>[<span class="s2">&quot;h2&quot;</span>])
<span class="kd">service </span><span class="nc">MyService</span><span class="w"> </span>{
<span class="w">    </span><span class="py">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2020-02-05&quot;</span>
}
</pre></div>
</div>
</section>
<section id="supported-traits">
<h2>Supported traits<a class="headerlink" href="#supported-traits" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">smithy.protocols#rpcv2Cbor</span></code> protocol supports the following traits
that affect serialization:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Trait</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="../../spec/http-bindings.html#cors-trait"><span class="std std-ref">cors</span></a></p></td>
<td><p>Indicates that the service supports CORS.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../spec/endpoint-traits.html#endpoint-trait"><span class="std std-ref">endpoint</span></a></p></td>
<td><p>Configures a custom operation endpoint.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../spec/endpoint-traits.html#hostlabel-trait"><span class="std std-ref">hostLabel</span></a></p></td>
<td><p>Binds a top-level operation input structure member to a label in
the hostPrefix of an endpoint trait.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../../spec/http-bindings.html#httperror-trait"><span class="std std-ref">httpError</span></a></p></td>
<td><p>A <code class="docutils literal notranslate"><span class="pre">client</span></code> error has a default status code of <code class="docutils literal notranslate"><span class="pre">400</span></code>, and a
<code class="docutils literal notranslate"><span class="pre">server</span></code> error has a default status code of <code class="docutils literal notranslate"><span class="pre">500</span></code>. The
<code class="docutils literal notranslate"><span class="pre">httpError</span></code> trait is used to define a custom status code.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../../spec/behavior-traits.html#requestcompression-trait"><span class="std std-ref">requestCompression</span></a></p></td>
<td><p>Indicates that an operation supports compressing requests from clients
to services.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="identification-for-claiming">
<h2>Identification for claiming<a class="headerlink" href="#identification-for-claiming" title="Link to this heading">¶</a></h2>
<p>Services that support this protocol MUST use the following characteristics to
identify and claim requests:</p>
<ol class="arabic simple">
<li><p>The Smithy-Protocol HTTP request header is set and contains the value
<code class="docutils literal notranslate"><span class="pre">rpc-v2-cbor</span></code>.</p></li>
<li><p>The HTTP request method is <code class="docutils literal notranslate"><span class="pre">POST</span></code>.</p></li>
<li><p>The HTTP request path matches the form <code class="docutils literal notranslate"><span class="pre">{prefix?}/service/{serviceName}/operation/{operationName}</span></code>.</p></li>
<li><p>The optional <code class="docutils literal notranslate"><span class="pre">{prefix?}</span></code> segment in the HTTP request path matches the
service’s runtime path prefix, if configured.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">{serviceName}</span></code> segment in the HTTP request path matches the <a class="reference internal" href="../../spec/model.html#grammar-token-smithy-Identifier"><code class="xref std std-token docutils literal notranslate"><span class="pre">shape</span> <span class="pre">name</span></code></a>
of the service's <a class="reference internal" href="../../spec/model.html#shape-id"><span class="std std-ref">Shape ID</span></a> in the Smithy model.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">{operationName}</span></code> segment in the HTTP request path matches a <a class="reference internal" href="../../spec/model.html#grammar-token-smithy-Identifier"><code class="xref std std-token docutils literal notranslate"><span class="pre">shape</span> <span class="pre">name</span></code></a>
of an operation bound to the service.</p></li>
</ol>
</section>
<section id="protocol-behaviors">
<h2>Protocol behaviors<a class="headerlink" href="#protocol-behaviors" title="Link to this heading">¶</a></h2>
<p>Implementations of the <code class="docutils literal notranslate"><span class="pre">smithy.protocols#rpcv2Cbor</span></code> protocol comply with the
following rules:</p>
<section id="requests">
<h3>Requests<a class="headerlink" href="#requests" title="Link to this heading">¶</a></h3>
<p>Every request for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol MUST contain a <code class="docutils literal notranslate"><span class="pre">Smithy-Protocol</span></code>
header with the value of <code class="docutils literal notranslate"><span class="pre">rpc-v2-cbor</span></code>.</p>
<p>Every request for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol MUST be sent using the HTTP
<code class="docutils literal notranslate"><span class="pre">POST</span></code> method. <a class="reference internal" href="../../spec/http-bindings.html#http-traits"><span class="std std-ref">HTTP binding traits</span></a> MUST be ignored when
building <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> requests if they are present.</p>
<p>Every request for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol MUST be sent to a URL with the
following form: <code class="docutils literal notranslate"><span class="pre">{prefix?}/service/{serviceName}/operation/{operationName}</span></code></p>
<ul class="simple">
<li><dl class="simple">
<dt>The Smithy RPCv2 CBOR protocol will only use the last four segments of the</dt><dd><p>URL when routing requests. For example, a service could use a <code class="docutils literal notranslate"><span class="pre">v1</span></code> prefix
in the URL path, which would not affect the operation a request is routed
to: <code class="docutils literal notranslate"><span class="pre">v1/service/FooService/operation/BarOperation</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>The <code class="docutils literal notranslate"><span class="pre">serviceName</span></code> segment MUST be replaced by the <a class="reference internal" href="../../spec/model.html#grammar-token-smithy-Identifier"><code class="xref std std-token docutils literal notranslate"><span class="pre">shape</span> <span class="pre">name</span></code></a></dt><dd><p>of the service's <a class="reference internal" href="../../spec/model.html#shape-id"><span class="std std-ref">Shape ID</span></a> in the Smithy model. The <code class="docutils literal notranslate"><span class="pre">serviceName</span></code>
produced by client implementations MUST NOT contain the namespace of the
<code class="docutils literal notranslate"><span class="pre">service</span></code> shape. Service implementations SHOULD accept an absolute shape
ID as the content of this segment with the <code class="docutils literal notranslate"><span class="pre">#</span></code> character replaced with a
<code class="docutils literal notranslate"><span class="pre">.</span></code> character, routing it the same as if only the name was specified. For
example, if the <code class="docutils literal notranslate"><span class="pre">service</span></code>'s absolute shape ID is
<code class="docutils literal notranslate"><span class="pre">com.example#TheService</span></code>, a service should accept both <code class="docutils literal notranslate"><span class="pre">TheService</span></code> and
<code class="docutils literal notranslate"><span class="pre">com.example.TheService</span></code> as values for the <code class="docutils literal notranslate"><span class="pre">serviceName</span></code> segment.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>The <code class="docutils literal notranslate"><span class="pre">operationName</span></code> segment MUST be replaced by the name of the <code class="docutils literal notranslate"><span class="pre">operation</span></code></dt><dd><p>shape in the Smithy. The <code class="docutils literal notranslate"><span class="pre">operationName</span></code> produced by client
implementations MUST NOT contain the namespace of the <code class="docutils literal notranslate"><span class="pre">operation</span></code> shape.
Service implementations MUST NOT accept an absolute shape ID as the content
of this segment.</p>
</dd>
</dl>
</li>
</ul>
<p>Requests for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol MUST use the following behavior for
setting a <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header:</p>
<ul class="simple">
<li><dl class="simple">
<dt>Buffered RPC requests: the value of the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header MUST be</dt><dd><p><code class="docutils literal notranslate"><span class="pre">application/cbor</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Event streaming requests: the value of the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header MUST be</dt><dd><p><code class="docutils literal notranslate"><span class="pre">application/vnd.amazon.eventstream</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Requests for operations with no defined input type (as in, they target the</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Unit</span></code> shape) MUST NOT contain bodies in their HTTP requests. The
<code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> for the serialization format MUST NOT be set.</p>
</dd>
</dl>
</li>
</ul>
<p>Requests for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol MUST NOT contain an <code class="docutils literal notranslate"><span class="pre">X-Amz-Target</span></code> or
<code class="docutils literal notranslate"><span class="pre">X-Amzn-Target</span></code> header. An <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> request is malformed if it contains
either of these headers. Server-side implementations MUST reject such requests
for security reasons.</p>
<p>Buffered RPC requests for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol SHOULD include a
<code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> header. Event streaming requests MUST NOT specify a content
length (instead using <code class="docutils literal notranslate"><span class="pre">Transfer-Encoding:</span> <span class="pre">chunked</span></code> on HTTP/1.1).</p>
<p>Requests for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol MUST use the following behavior for
setting an <code class="docutils literal notranslate"><span class="pre">Accept</span></code> header:</p>
<ul class="simple">
<li><dl class="simple">
<dt>For requests with event streaming responses: the value of the <code class="docutils literal notranslate"><span class="pre">Accept</span></code></dt><dd><p>header MUST be <code class="docutils literal notranslate"><span class="pre">application/vnd.amazon.eventstream</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>For requests with all other response types: the value of the <code class="docutils literal notranslate"><span class="pre">Accept</span></code></dt><dd><p>header MUST be <code class="docutils literal notranslate"><span class="pre">application/cbor</span></code>.</p>
</dd>
</dl>
</li>
</ul>
<p>Other forms of content streaming MAY be added in the future, utilizing
different values for <code class="docutils literal notranslate"><span class="pre">Accept</span></code>.</p>
<p>In summary, the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol defines behavior for the following
headers for requests:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 18.0%" />
<col style="width: 18.0%" />
<col style="width: 64.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Header</p></th>
<th class="head"><p>Status</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Smithy-Protocol</span></code></p></td>
<td><p>Required</p></td>
<td><p>The value of <code class="docutils literal notranslate"><span class="pre">rpc-v2-cbor</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Content-Type</span></code></p></td>
<td><p>Required with request bodies</p></td>
<td><p>The value of <code class="docutils literal notranslate"><span class="pre">application/cbor</span></code>. For event streaming requests, this
is <code class="docutils literal notranslate"><span class="pre">application/vnd.amazon.eventstream</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Content-Length</span></code></p></td>
<td><p>Conditional</p></td>
<td><p>The standard <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> header defined by <span class="target" id="index-0"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9110.html#section-8.6"><strong>RFC 9110 Section 8.6</strong></a>.
For event streaming requests, this MUST NOT be set.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Accept</span></code></p></td>
<td><p>Required</p></td>
<td><p>The value of <code class="docutils literal notranslate"><span class="pre">application/cbor</span></code>. For requests with event streaming
responses, this is <code class="docutils literal notranslate"><span class="pre">application/vnd.amazon.eventstream</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="responses">
<h3>Responses<a class="headerlink" href="#responses" title="Link to this heading">¶</a></h3>
<p>The status code for successful <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> responses MUST be <code class="docutils literal notranslate"><span class="pre">200</span></code>.</p>
<p>The status code for error <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> MUST be determined by the following
steps:</p>
<ol class="arabic simple">
<li><p>If the <a class="reference internal" href="../../spec/http-bindings.html#httperror-trait"><span class="std std-ref">httpError</span></a> trait is set on the error shape,
its value is used.</p></li>
<li><p>If the <a class="reference internal" href="../../spec/type-refinement-traits.html#error-trait"><span class="std std-ref">error</span></a> trait is set to <code class="docutils literal notranslate"><span class="pre">server</span></code>, the value
MUST be <code class="docutils literal notranslate"><span class="pre">500</span></code>.</p></li>
<li><p>Otherwise, the value MUST be <code class="docutils literal notranslate"><span class="pre">400</span></code>.</p></li>
</ol>
<p>Every response for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol MUST contain a <code class="docutils literal notranslate"><span class="pre">Smithy-Protocol</span></code>
header with the value of <code class="docutils literal notranslate"><span class="pre">rpc-v2-cbor</span></code>. The response MUST match the value of
the <code class="docutils literal notranslate"><span class="pre">Smithy-Protocol</span></code> header from the request.</p>
<p>Responses for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol MUST use the following behavior for
setting a <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header:</p>
<ul class="simple">
<li><p>Buffered RPC responses: the value of the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header MUST be
<code class="docutils literal notranslate"><span class="pre">application/cbor</span></code>.</p></li>
<li><p>Event streaming responses: the value of the <code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> header MUST be
<code class="docutils literal notranslate"><span class="pre">application/vnd.amazon.eventstream</span></code>.</p></li>
<li><p>Responses for operations with no defined output type (as in, they target the
<code class="docutils literal notranslate"><span class="pre">Unit</span></code> shape) MUST NOT contain bodies in their HTTP responses. The
<code class="docutils literal notranslate"><span class="pre">Content-Type</span></code> for the serialization format MUST NOT be set.</p></li>
</ul>
<p>Buffered RPC responses for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol SHOULD include a
<code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> header. Event streaming responses SHOULD NOT specify a
content length (instead using <code class="docutils literal notranslate"><span class="pre">Transfer-Encoding:</span> <span class="pre">chunked</span></code> on HTTP/1.1).</p>
<p>Responses for the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol SHOULD NOT contain the
<code class="docutils literal notranslate"><span class="pre">X-Amzn-ErrorType</span></code> header. Type information is always serialized in the
payload. Clients MUST ignore this header. See <a class="reference internal" href="#operation-error-serialization">Operation error serialization</a>
for information on the serialization of error responses.</p>
<p>In summary, the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol defines behavior for the following
headers for responses:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 18.0%" />
<col style="width: 18.0%" />
<col style="width: 64.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Header</p></th>
<th class="head"><p>Status</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Smithy-Protocol</span></code></p></td>
<td><p>Required</p></td>
<td><p>The value of <code class="docutils literal notranslate"><span class="pre">rpc-v2-cbor</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Content-Type</span></code></p></td>
<td><p>Required with response bodies</p></td>
<td><p>The value of <code class="docutils literal notranslate"><span class="pre">application/cbor</span></code>. For event streaming responses, this
is <code class="docutils literal notranslate"><span class="pre">application/vnd.amazon.eventstream</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Content-Length</span></code></p></td>
<td><p>Conditional</p></td>
<td><p>The standard <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> header defined by <span class="target" id="index-1"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc9110.html#section-8.6"><strong>RFC 9110 Section 8.6</strong></a>.
For event streaming requests, this SHOULD NOT be set.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section id="shape-serialization">
<h2>Shape serialization<a class="headerlink" href="#shape-serialization" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">smithy.protocols#rpcv2Cbor</span></code> protocol serializes all shapes into a CBOR
document body with no HTTP bindings supported. The following table shows how
to convert each shape type:</p>
<div class="table-wrapper colwidths-given docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Smithy type</p></th>
<th class="head"><p>CBOR representation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">blob</span></code></p></td>
<td><p><span class="target" id="index-2"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.5"><strong>Major type 2 (byte string)</strong></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td><p><span class="target" id="index-3"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.15"><strong>Major type 7 (simple)</strong></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">byte</span></code></p></td>
<td><p><span class="target" id="index-4"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.1"><strong>Major type 0 (unsigned integer)</strong></a> or
<span class="target" id="index-5"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.3"><strong>major type 1 (negative integer)</strong></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">short</span></code></p></td>
<td><p><span class="target" id="index-6"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.1"><strong>Major type 0 (unsigned integer)</strong></a> or
<span class="target" id="index-7"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.3"><strong>major type 1 (negative integer)</strong></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">integer</span></code></p></td>
<td><p><span class="target" id="index-8"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.1"><strong>Major type 0 (unsigned integer)</strong></a> or
<span class="target" id="index-9"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.3"><strong>major type 1 (negative integer)</strong></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">long</span></code></p></td>
<td><p><span class="target" id="index-10"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.1"><strong>Major type 0 (unsigned integer)</strong></a> or
<span class="target" id="index-11"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.3"><strong>major type 1 (negative integer)</strong></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td><p><span class="target" id="index-12"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.15"><strong>Major type 7 (float)</strong></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">double</span></code></p></td>
<td><p><span class="target" id="index-13"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.15"><strong>Major type 7 (float)</strong></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bigInteger</span></code></p></td>
<td><p><span class="target" id="index-14"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.13"><strong>Major type 6</strong></a>, value
<span class="target" id="index-15"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.4"><strong>tags 2 (unsigned bignum) or 3 (negative bignum)</strong></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">bigDecimal</span></code></p></td>
<td><p><span class="target" id="index-16"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.13"><strong>Major type 6</strong></a>, value
<span class="target" id="index-17"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.4"><strong>tag 4 (decimal fraction)</strong></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">string</span></code></p></td>
<td><p><span class="target" id="index-18"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.7"><strong>Major type 3 (text string)</strong></a></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">timestamp</span></code></p></td>
<td><p>See <a class="reference internal" href="#timestamp-type-serialization">Timestamp type serialization</a>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">document</span></code></p></td>
<td><p>Document types are not currently supported in this protocol.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">list</span></code></p></td>
<td><p><span class="target" id="index-19"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.9"><strong>Major type 4 (array of data items)</strong></a></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">map</span></code></p></td>
<td><p><span class="target" id="index-20"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.11"><strong>Major type 5 (map of pairs of data items)</strong></a>,
each key/value pair is a pair in the type</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">structure</span></code></p></td>
<td><p><span class="target" id="index-21"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.11"><strong>Major type 5 (map of pairs of data items)</strong></a>,
each member is the key to a pair in the type</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">union</span></code></p></td>
<td><p><span class="target" id="index-22"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.11"><strong>Major type 5 (map of pairs of data items)</strong></a>,
each member is the key to a pair in the type.</p>
<p>A union is serialized identically as a <code class="docutils literal notranslate"><span class="pre">structure</span></code>
shape, but only a single member can be set to a non-null value.
Deserializers MUST ignore an unrecognized <code class="docutils literal notranslate"><span class="pre">__type</span></code> member if present.</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Values that are <code class="docutils literal notranslate"><span class="pre">null</span></code> MUST be omitted from wire contents where not subject
to <a class="reference internal" href="#default-value-serialization">default value serialization</a> rules.</p>
<p>If an implementation does not support arbitrary precision (<code class="docutils literal notranslate"><span class="pre">bigInteger</span></code> and
<code class="docutils literal notranslate"><span class="pre">bigDecimal</span></code> Smithy types), it MUST fail when attempting to deserialize a
value of that type.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">undefined</span></code> CBOR value, CBOR <span class="target" id="index-23"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.15"><strong>major type 7</strong></a>
<span class="target" id="index-24"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.3"><strong>value 23</strong></a>, is not supported. Clients SHOULD NOT
serialize to this CBOR value and SHOULD deserialize this CBOR value to
<code class="docutils literal notranslate"><span class="pre">null</span></code>. Servers MUST NOT serialize to this CBOR value and MUST
deserialize this CBOR value to <code class="docutils literal notranslate"><span class="pre">null</span></code>.</p>
</div>
<section id="numeric-type-serialization">
<h3>Numeric type serialization<a class="headerlink" href="#numeric-type-serialization" title="Link to this heading">¶</a></h3>
<p>Numeric types (<code class="docutils literal notranslate"><span class="pre">byte</span></code>, <code class="docutils literal notranslate"><span class="pre">short</span></code>, <code class="docutils literal notranslate"><span class="pre">integer</span></code>, <code class="docutils literal notranslate"><span class="pre">long</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, and <code class="docutils literal notranslate"><span class="pre">double</span></code>)
SHOULD be serialized into the smallest possible CBOR type representation that
can contain its value. For example, a field modeled as a <code class="docutils literal notranslate"><span class="pre">long</span></code> with a value of
1 should be sent in a single byte.</p>
<p>Floating-point numeric types (<code class="docutils literal notranslate"><span class="pre">float</span></code> and <code class="docutils literal notranslate"><span class="pre">double</span></code>) MAY be serialized into
non-floating-point numeric types (<code class="docutils literal notranslate"><span class="pre">byte</span></code>, <code class="docutils literal notranslate"><span class="pre">short</span></code>, <code class="docutils literal notranslate"><span class="pre">integer</span></code>, and <code class="docutils literal notranslate"><span class="pre">long</span></code>) if
and only if the conversion would not cause a loss of precision. For example, a
field modeled as a <code class="docutils literal notranslate"><span class="pre">float</span></code> with a value of 256 may be sent as an integer.</p>
<p>As support for half-precision floating-point values is inconsistent across
implementations, floating-point numeric types SHOULD NOT serialize into a
half-precision (16 bit) numeric CBOR values. Implementations MUST be capable of
deserializing half-precision numeric CBOR values (including -Infinity,
Infinity, and NAN) into their Smithy type representation.</p>
<p>Numeric types MUST be deserialized into their Smithy type representation. For
example, a field modeled as a <code class="docutils literal notranslate"><span class="pre">long</span></code> with a single byte value of 1 must be
deserialized into a long.</p>
</section>
<section id="timestamp-type-serialization">
<h3>Timestamp type serialization<a class="headerlink" href="#timestamp-type-serialization" title="Link to this heading">¶</a></h3>
<p>Timestamps are serialized as <span class="target" id="index-25"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.13"><strong>major type 6</strong></a>, value
<span class="target" id="index-26"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.4"><strong>tag 1 (epoch-based date/time)</strong></a> to indicate the tagged
value is an epoch timestamp. Values are either <span class="target" id="index-27"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.1"><strong>major type 0 (unsigned integer)</strong></a>
or <span class="target" id="index-28"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.3"><strong>major type 1 (negative integer)</strong></a> for integer
values or <span class="target" id="index-29"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.1-2.15"><strong>major type 7</strong></a>,
<span class="target" id="index-30"></span><a class="rfc reference external" href="https://datatracker.ietf.org/doc/html/rfc8949.html#section-3.3"><strong>value 25 (half-precision float), 26 (single-precision float), or 27 (double-precision float)</strong></a>
for floating-point values.</p>
<p>As support for half-precision floating-point values is inconsistent across
implementations, timestamp types SHOULD NOT serialize into a half-precision
(16 bit) numeric CBOR value for the tagged value.</p>
<p>This protocol uses <code class="docutils literal notranslate"><span class="pre">epoch-seconds</span></code>, also known as Unix timestamps, with
millisecond (1/1000th of a second) resolution. The <a class="reference internal" href="../../spec/protocol-traits.html#timestampformat-trait"><span class="std std-ref">timestampFormat</span></a>
MUST NOT be respected to customize timestamp serialization.</p>
</section>
<section id="default-value-serialization">
<h3>Default value serialization<a class="headerlink" href="#default-value-serialization" title="Link to this heading">¶</a></h3>
<p>To avoid information disclosure, service serializers SHOULD omit the default
value of structure members that are marked with the <a class="reference internal" href="../../spec/documentation-traits.html#internal-trait"><span class="std std-ref">internal trait</span></a>.</p>
<p>Client deserializers SHOULD attempt to error correct structures that omit a
<a class="reference internal" href="../../spec/type-refinement-traits.html#required-trait"><span class="std std-ref">required</span></a> member by filling in a default zero value for
the member. Error correction allows clients to continue to function while the
server is in error.</p>
</section>
</section>
<section id="operation-response-deserialization">
<h2>Operation response deserialization<a class="headerlink" href="#operation-response-deserialization" title="Link to this heading">¶</a></h2>
<p>Clients MUST use the following rules to interpret responses and determine how
to deserialize them:</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>If the response does not have the same <code class="docutils literal notranslate"><span class="pre">Smithy-Protocol</span></code> header as the</dt><dd><p>request, it MUST be considered malformed. Clients who receive a malformed
response MUST handle it (i.e. throw a reasonable exception) based solely on
the HTTP response code. No attempt should be made to interpret the response
body or headers.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>If the response code is <code class="docutils literal notranslate"><span class="pre">200</span></code>, the request is successful and the response</dt><dd><p>payload SHALL be deserialized as the <code class="docutils literal notranslate"><span class="pre">output</span></code> shape defined on the
operation.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Finally, if the response code is not <code class="docutils literal notranslate"><span class="pre">200</span></code>, the response payload is an</dt><dd><p>exception and SHALL be deserialized according to <a class="reference internal" href="#operation-error-serialization">Operation error serialization</a></p>
</dd>
</dl>
</li>
</ol>
<section id="operation-error-serialization">
<h3>Operation error serialization<a class="headerlink" href="#operation-error-serialization" title="Link to this heading">¶</a></h3>
<p>Error responses in the <code class="docutils literal notranslate"><span class="pre">rpcv2Cbor</span></code> protocol MUST be serialized identically to
standard responses with one additional component to distinguish which error is
contained: a body field named <code class="docutils literal notranslate"><span class="pre">__type</span></code>. This value of this component MUST
contain the error’s absolute <a class="reference internal" href="../../spec/model.html#shape-id"><span class="std std-ref">Shape ID</span></a>.</p>
<p>By default, all error shapes have a <code class="docutils literal notranslate"><span class="pre">message</span></code> field containing an
error-specific message meant for human consumers of API errors. Services MUST
support generating this field and serializing it when responding. Clients MUST
support generating this field and deserializing it from responses.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Code</span></code> response body field and <code class="docutils literal notranslate"><span class="pre">code</span></code> response body field MUST NOT be
used to distinguish which error is contained in a response.</p>
<p>Clients who receive a malformed error response MUST handle it based solely on
the HTTP response code (i.e. throw a reasonable exception). No attempt should
be made to interpret the response body or headers.</p>
</section>
</section>
<section id="error-shape-renaming">
<h2>Error shape renaming<a class="headerlink" href="#error-shape-renaming" title="Link to this heading">¶</a></h2>
<p>By default, Smithy permits renaming shapes to disambiguate shape ID conflicts in
the <a class="reference internal" href="../../spec/service-types.html#service-closure"><span class="std std-ref">service closure</span></a> via the <code class="docutils literal notranslate"><span class="pre">rename</span></code> property. However, services using this protocol are
not allowed to rename error shapes (shapes with <a class="reference internal" href="../../spec/type-refinement-traits.html#error-trait"><span class="std std-ref">error trait</span></a> applied).</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../aws/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">AWS integrations</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Protocols</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Amazon Web Services
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/smithy-lang/smithy" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Smithy RPC v2 CBOR protocol</a><ul>
<li><a class="reference internal" href="#smithy-protocols-rpcv2cbor-trait"><code class="docutils literal notranslate"><span class="pre">smithy.protocols#rpcv2Cbor</span></code> trait</a></li>
<li><a class="reference internal" href="#supported-traits">Supported traits</a></li>
<li><a class="reference internal" href="#identification-for-claiming">Identification for claiming</a></li>
<li><a class="reference internal" href="#protocol-behaviors">Protocol behaviors</a><ul>
<li><a class="reference internal" href="#requests">Requests</a></li>
<li><a class="reference internal" href="#responses">Responses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#shape-serialization">Shape serialization</a><ul>
<li><a class="reference internal" href="#numeric-type-serialization">Numeric type serialization</a></li>
<li><a class="reference internal" href="#timestamp-type-serialization">Timestamp type serialization</a></li>
<li><a class="reference internal" href="#default-value-serialization">Default value serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operation-response-deserialization">Operation response deserialization</a><ul>
<li><a class="reference internal" href="#operation-error-serialization">Operation error serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#error-shape-renaming">Error shape renaming</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=60dbed4a"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=6b89569b"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    </body>
</html>